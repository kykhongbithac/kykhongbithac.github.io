<!DOCTYPE html>


<html theme="dark" showBanner="true" hasBanner="true" > 
<link href="https://cdn.staticfile.org/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet">
<link href="https://cdn.staticfile.org/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet">
<link href="https://cdn.staticfile.org/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet">
<script src="/js/color.global.min.js" ></script>
<script src="/js/load-settings.js" ></script>
<head>
  <meta charset="utf-8">
  
  
  

  
  <title>Reverse/HCMUS-CTF 2025 | nukoneZ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="preload" href="/css/fonts/Roboto-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous">
  <link rel="preload" href="/css/fonts/Roboto-Bold.ttf" as="font" type="font/ttf" crossorigin="anonymous">

  <meta name="description" content="ReversingReversing&#x2F;Git Gud I didn’t find this challenge particularly interesting, as it focused mainly on forensic techniques. Therefore, I’ll just provide a brief summary. You just need to focus">
<meta property="og:type" content="article">
<meta property="og:title" content="Reverse&#x2F;HCMUS-CTF 2025">
<meta property="og:url" content="https://kykhongbithac.github.io/2025/08/19/hcmusctf2025/">
<meta property="og:site_name" content="nukoneZ">
<meta property="og:description" content="ReversingReversing&#x2F;Git Gud I didn’t find this challenge particularly interesting, as it focused mainly on forensic techniques. Therefore, I’ll just provide a brief summary. You just need to focus">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://hackmd.io/_uploads/SytXWX0Ugg.png">
<meta property="og:image" content="https://hackmd.io/_uploads/H13tfXRLxg.png">
<meta property="og:image" content="https://hackmd.io/_uploads/B1sWzK98lx.png">
<meta property="og:image" content="https://hackmd.io/_uploads/Hkby8Yc8xl.png">
<meta property="og:image" content="https://hackmd.io/_uploads/Sk7LLt5Ixl.png">
<meta property="og:image" content="https://hackmd.io/_uploads/rkCLJY98lx.png">
<meta property="og:image" content="https://hackmd.io/_uploads/HJiPZ_58xx.png">
<meta property="article:published_time" content="2025-08-19T05:00:00.000Z">
<meta property="article:modified_time" content="2025-08-19T14:18:20.000Z">
<meta property="article:author" content="Huỳnh Quốc Kỳ">
<meta property="article:tag" content="Reverse">
<meta property="article:tag" content="HCMUS-CTF-2025">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://hackmd.io/_uploads/SytXWX0Ugg.png">
  
    <link rel="alternate" href="/atom.xml" title="nukoneZ" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/image/favicon.png">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 7.3.0"></head>

<body>
  
  
    
<div id="banner" class="">
  <img src="/image/background.gif" itemprop="image">
  <div id="banner-dim"></div>
</div>
 
   
  <div id="main-grid" class="  ">
    <div id="nav" class=""  >
      <navbar id="navbar">
  <nav id="title-nav">
    <a href="/">
      <div id="vivia-logo">
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
      </div>
      <div>nukoneZ </div>
    </a>
  </nav>
  <nav id="main-nav">
    
      <a class="main-nav-link" href="/">Home</a>
    
      <a class="main-nav-link" href="/archives">Archives</a>
    
      <a class="main-nav-link" href="/about">About</a>
    
  </nav>
  <nav id="sub-nav">
    <a id="theme-btn" class="nav-icon">
      <span class="light-mode-icon"><svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M438.5-829.913v-48q0-17.452 11.963-29.476 11.964-12.024 29.326-12.024 17.363 0 29.537 12.024t12.174 29.476v48q0 17.452-11.963 29.476-11.964 12.024-29.326 12.024-17.363 0-29.537-12.024T438.5-829.913Zm0 747.826v-48q0-17.452 11.963-29.476 11.964-12.024 29.326-12.024 17.363 0 29.537 12.024t12.174 29.476v48q0 17.452-11.963 29.476-11.964 12.024-29.326 12.024-17.363 0-29.537-12.024T438.5-82.087ZM877.913-438.5h-48q-17.452 0-29.476-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537t29.476-12.174h48q17.452 0 29.476 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T877.913-438.5Zm-747.826 0h-48q-17.452 0-29.476-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537T82.087-521.5h48q17.452 0 29.476 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T130.087-438.5Zm660.174-290.87-34.239 32q-12.913 12.674-29.565 12.174-16.653-.5-29.327-13.174-12.674-12.673-12.554-28.826.12-16.152 12.794-28.826l33-35q12.913-12.674 30.454-12.674t30.163 12.847q12.709 12.846 12.328 30.826-.38 17.98-13.054 30.653ZM262.63-203.978l-32 34q-12.913 12.674-30.454 12.674t-30.163-12.847q-12.709-12.846-12.328-30.826.38-17.98 13.054-30.653l33.239-31q12.913-12.674 29.565-12.174 16.653.5 29.327 13.174 12.674 12.673 12.554 28.826-.12 16.152-12.794 28.826Zm466.74 33.239-32-33.239q-12.674-12.913-12.174-29.565.5-16.653 13.174-29.327 12.673-12.674 28.826-13.054 16.152-.38 28.826 12.294l35 33q12.674 12.913 12.674 30.454t-12.847 30.163q-12.846 12.709-30.826 12.328-17.98-.38-30.653-13.054ZM203.978-697.37l-34-33q-12.674-12.913-13.174-29.945-.5-17.033 12.174-29.707t31.326-13.293q18.653-.62 31.326 13.054l32 34.239q11.674 12.913 11.174 29.565-.5 16.653-13.174 29.327-12.673 12.674-28.826 12.554-16.152-.12-28.826-12.794ZM480-240q-100 0-170-70t-70-170q0-100 70-170t170-70q100 0 170 70t70 170q0 100-70 170t-170 70Zm-.247-82q65.703 0 111.475-46.272Q637-414.544 637-480.247t-45.525-111.228Q545.95-637 480.247-637t-111.475 45.525Q323-545.95 323-480.247t45.525 111.975Q414.05-322 479.753-322ZM481-481Z"/></svg></span>
      <span class="dark-mode-icon"><svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M480.239-116.413q-152.63 0-258.228-105.478Q116.413-327.37 116.413-480q0-130.935 77.739-227.435t206.304-125.043q43.022-9.631 63.87 10.869t3.478 62.805q-8.891 22.043-14.315 44.463-5.424 22.42-5.424 46.689 0 91.694 64.326 155.879 64.325 64.186 156.218 64.186 24.369 0 46.978-4.946 22.609-4.945 44.413-14.076 42.826-17.369 62.967 1.142 20.142 18.511 10.511 61.054Q807.174-280 712.63-198.206q-94.543 81.793-232.391 81.793Zm0-95q79.783 0 143.337-40.217 63.554-40.218 95.793-108.283-15.608 4.044-31.097 5.326-15.49 1.283-31.859.805-123.706-4.066-210.777-90.539-87.071-86.473-91.614-212.092-.24-16.369.923-31.978 1.164-15.609 5.446-30.978-67.826 32.478-108.282 96.152Q211.652-559.543 211.652-480q0 111.929 78.329 190.258 78.329 78.329 190.258 78.329ZM466.13-465.891Z"/></svg></span>
    </a>
    
      <a id="nav-rss-link" class="nav-icon mobile-hide" href="/atom.xml" title="RSS Feed">
        <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M198-120q-25.846 0-44.23-18.384-18.384-18.385-18.384-44.23 0-25.846 18.384-44.23 18.384-18.385 44.23-18.385 25.846 0 44.23 18.385 18.384 18.384 18.384 44.23 0 25.845-18.384 44.23Q223.846-120 198-120Zm538.385 0q-18.846 0-32.923-13.769-14.076-13.769-15.922-33.23-8.692-100.616-51.077-188.654-42.385-88.039-109.885-155.539-67.5-67.501-155.539-109.885Q283-663.462 182.385-672.154q-19.461-1.846-33.23-16.23-13.769-14.385-13.769-33.846t14.076-32.922q14.077-13.461 32.923-12.23 120.076 8.692 226.038 58.768 105.961 50.077 185.73 129.846 79.769 79.769 129.846 185.731 50.077 105.961 58.769 226.038 1.231 18.846-12.538 32.922Q756.461-120 736.385-120Zm-252 0q-18.231 0-32.423-13.461t-18.653-33.538Q418.155-264.23 348.886-333.5q-69.27-69.27-166.501-84.423-20.077-4.462-33.538-18.961-13.461-14.5-13.461-33.346 0-19.076 13.884-33.23 13.884-14.153 33.115-10.922 136.769 15.384 234.384 112.999 97.615 97.615 112.999 234.384 3.231 19.23-10.538 33.115Q505.461-120 484.385-120Z"/></svg>
      </a>
    
    <div id="nav-menu-btn" class="nav-icon">
      <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M177.37-252.282q-17.453 0-29.477-11.964-12.024-11.963-12.024-29.326t12.024-29.537q12.024-12.174 29.477-12.174h605.26q17.453 0 29.477 11.964 12.024 11.963 12.024 29.326t-12.024 29.537q-12.024 12.174-29.477 12.174H177.37Zm0-186.218q-17.453 0-29.477-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537T177.37-521.5h605.26q17.453 0 29.477 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T782.63-438.5H177.37Zm0-186.217q-17.453 0-29.477-11.964-12.024-11.963-12.024-29.326t12.024-29.537q12.024-12.174 29.477-12.174h605.26q17.453 0 29.477 11.964 12.024 11.963 12.024 29.326t-12.024 29.537q-12.024 12.174-29.477 12.174H177.37Z"/></svg>
    </div>
  </nav>
</navbar>
<div id="nav-dropdown" class="hidden">
  <div id="dropdown-link-list">
    
      <a class="nav-dropdown-link" href="/">Home</a>
    
      <a class="nav-dropdown-link" href="/archives">Archives</a>
    
      <a class="nav-dropdown-link" href="/about">About</a>
    
    
      <a class="nav-dropdown-link" href="/atom.xml" title="RSS Feed">RSS</a>
     
    </div>
</div>
<script>
  let dropdownBtn = document.getElementById("nav-menu-btn");
  let dropdownEle = document.getElementById("nav-dropdown");
  dropdownBtn.onclick = function() {
    dropdownEle.classList.toggle("hidden");
  }
</script>
    </div>
    <div id="sidebar-wrapper">
      <sidebar id="sidebar">
  
    <div class="widget-wrap">
  <div class="info-card">
    <div class="avatar">
      
        <image src=/image/avata.gif></image>
      
      <div class="img-dim"></div>
    </div>
    <div class="info">
      <div class="username">nukoneZ </div>
      <div class="dot"></div>
      <div class="subtitle">Blog | CTF | Security </div>
      <div class="link-list">
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://www.facebook.com/quocky05" title="Facebook"><i class="fa-brands fa-facebook"></i></a>
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://www.instagram.com/nukonez" title="Instagram"><i class="fa-brands fa-instagram"></i></a>
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://github.com/kykhongbithac" title="GitHub"><i class="fa-brands fa-github"></i></a>
        
          <a class="link-btn" href="mailto:huynhky3010@gmail.com" title="Gmail"><i class="fa-solid fa-envelope"></i></a>
         
      </div>  
    </div>
  </div>
</div>

  
  <div class="sticky">
    
      


  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">Categories</h3>
      <div class="category-box">
            <a class="category-link" href="/categories/Malware-Analysis/">
                Malware Analysis
                <div class="category-count">1</div>
            </a>
        
            <a class="category-link" href="/categories/Write-up/">
                Write-up
                <div class="category-count">6</div>
            </a>
        
            <a class="category-link" href="/categories/Blog/">
                Blog
                <div class="category-count">1</div>
            </a>
        </div>
    </div>
  </div>


    
      
  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">Tags</h3>
      <ul class="widget-tag-list" itemprop="keywords"><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Analysis/" rel="tag">Analysis</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/CTF/" rel="tag">CTF</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/FPTU/" rel="tag">FPTU</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/HCMUS-CTF-2025/" rel="tag">HCMUS-CTF-2025</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/HOLACTF2025/" rel="tag">HOLACTF2025</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/HackTheBox/" rel="tag">HackTheBox</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/HacktheonSejong/" rel="tag">HacktheonSejong</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Korea-%F0%9F%87%B0%F0%9F%87%B7/" rel="tag">Korea 🇰🇷</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Malware/" rel="tag">Malware</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/PTITHCM-CTF-2025/" rel="tag">PTITHCM CTF 2025</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Reverse/" rel="tag">Reverse</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Reverse-Engineering/" rel="tag">Reverse Engineering</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ScriptCTF2025/" rel="tag">ScriptCTF2025</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Security/" rel="tag">Security</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Trips/" rel="tag">Trips</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/VM/" rel="tag">VM</a></li></ul>
    </div>
  </div>


    
      
  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">Archives</h3>
      
      
        <a class="archive-link" href="/archives/2025/09 ">
          September 2025 
          <div class="archive-count">2 </div>
        </a>
      
        <a class="archive-link" href="/archives/2025/08 ">
          August 2025 
          <div class="archive-count">6 </div>
        </a>
      
    </div>
  </div>


    
      
  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">Recent Posts</h3>
      <ul>
        
          <a class="recent-link" href="/2025/09/17/fob%20PTITHCM%20CTF%202025/" title="Reverse/fob (PTITHCM 2025)" >
            <div class="recent-link-text">
              Reverse/fob (PTITHCM 2025)
            </div>
          </a>
        
          <a class="recent-link" href="/2025/09/01/HOLACTF%202025%20Writeups/" title="HOLACTF 2025 Writeups" >
            <div class="recent-link-text">
              HOLACTF 2025 Writeups
            </div>
          </a>
        
          <a class="recent-link" href="/2025/08/19/Korea-2025/" title="Hacktheon Sejong 2025 🇰🇷" >
            <div class="recent-link-text">
              Hacktheon Sejong 2025 🇰🇷
            </div>
          </a>
        
          <a class="recent-link" href="/2025/08/19/Indefinite/" title="Reverse/Indefinite" >
            <div class="recent-link-text">
              Reverse/Indefinite
            </div>
          </a>
        
          <a class="recent-link" href="/2025/08/19/hcmusctf2025/" title="Reverse/HCMUS-CTF 2025" >
            <div class="recent-link-text">
              Reverse/HCMUS-CTF 2025
            </div>
          </a>
        
      </ul>
    </div>
  </div>

    
  </div>
</sidebar>
    </div>
    <div id="content-body">
       


<article id="post-hcmusctf2025" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
    
   
  <div class="article-inner">
    <div class="article-main">
      <header class="article-header">
        
<div class="main-title-bar">
  <div class="main-title-dot"></div>
  
    
      <h1 class="p-name article-title" itemprop="headline name">
        Reverse/HCMUS-CTF 2025
      </h1>
    
  
</div>

        <div class='meta-info-bar'>
          <div class="meta-info">
  <time class="dt-published" datetime="2025-08-19T05:00:00.000Z" itemprop="datePublished">2025-08-19</time>
</div>
          <div class="need-seperator meta-info">
            <div class="meta-cate-flex">
  
  <a class="meta-cate-link" href="/categories/Write-up/">Write-up</a>
   
</div>
  
          </div>
          <div class="wordcount need-seperator meta-info">
            22k words 
          </div>
        </div>
        
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/HCMUS-CTF-2025/" rel="tag">HCMUS-CTF-2025</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Reverse/" rel="tag">Reverse</a></li></ul>

      </header>
      <div class="e-content article-entry" itemprop="articleBody">
        
          <h1 id="Reversing"><a href="#Reversing" class="headerlink" title="Reversing"></a>Reversing</h1><h2 id="Reversing-Git-Gud"><a href="#Reversing-Git-Gud" class="headerlink" title="Reversing&#x2F;Git Gud"></a>Reversing&#x2F;Git Gud</h2><ul>
<li>I didn’t find this challenge particularly interesting, as it focused mainly on forensic techniques. Therefore, I’ll just provide a brief summary.</li>
<li>You just need to focus on the file in the pack directory named <code>c1edf5ae097edd6153379cf537d33a71a6b22718.pack</code>. I performed a reverse XOR with the <code>PACK</code> header and obtained the result: <code>0x1d</code>.<br><img src="https://hackmd.io/_uploads/SytXWX0Ugg.png" alt="image"></li>
<li>Once I retrieved the <code>PACK</code> file, I utilized various forensic methods to reconstruct and analyze its original form.</li>
<li>These are some of the commands I used to recover the file. You can explore them further to understand how the recovery works.<blockquote>
<p>git index-pack -v download.pack<br> git verify-pack -v pack-3f16b5775d22b956bba03cc9929ca28b1f69d309.idx<br>ls -l pack-3f16b5775d22b956bba03cc9929ca28b1f69d309.*<br>mkdir unpacked &amp;&amp; cd unpacked<br>git unpack-objects &lt; ..&#x2F;pack-3f16b5775d22b956bba03cc9929ca28b1f69d309.pack<br>git cat-file -p ec75d6adad3e5ccf610281861d612165521ca547</p>
</blockquote>
</li>
</ul>
<p><img src="https://hackmd.io/_uploads/H13tfXRLxg.png" alt="image"></p>
<blockquote>
<p>FLAG: HCMUS-CTF{securely_protect3d_by_g1t}</p>
</blockquote>
<h2 id="Reversing-nmb"><a href="#Reversing-nmb" class="headerlink" title="Reversing&#x2F;nmb"></a>Reversing&#x2F;nmb</h2><ul>
<li>In this challenge, I received a <code>main.exe</code> file whose code after compilation is still unclear.<br><img src="https://hackmd.io/_uploads/B1sWzK98lx.png" alt="image"></li>
<li>It’s hard to be static at first glance, so I’ll debug it and see.</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">_BYTE *<span class="title">sub_7FF7F510947D</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 (__fastcall *v0)(); <span class="comment">// rsi</span></span><br><span class="line">  __int64 v1; <span class="comment">// rax</span></span><br><span class="line">  _BYTE *result; <span class="comment">// rax</span></span><br><span class="line">  _BYTE *v3; <span class="comment">// rbx</span></span><br><span class="line">  __int64 v4; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">size_t</span> v5; <span class="comment">// r12</span></span><br><span class="line">  <span class="type">size_t</span> v6; <span class="comment">// rdi</span></span><br><span class="line">  <span class="type">size_t</span> v7; <span class="comment">// r14</span></span><br><span class="line">  <span class="type">size_t</span> v8; <span class="comment">// r15</span></span><br><span class="line">  <span class="type">size_t</span> v9; <span class="comment">// rcx</span></span><br><span class="line">  <span class="type">bool</span> v10; <span class="comment">// zf</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v11; <span class="comment">// rsi</span></span><br><span class="line">  <span class="type">size_t</span> v12; <span class="comment">// r12</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v13; <span class="comment">// [rsp+28h] [rbp-B0h]</span></span><br><span class="line">  __int128 v14; <span class="comment">// [rsp+30h] [rbp-A8h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int128 v15; <span class="comment">// [rsp+40h] [rbp-98h] BYREF</span></span><br><span class="line">  <span class="type">size_t</span> Size[<span class="number">2</span>]; <span class="comment">// [rsp+50h] [rbp-88h] BYREF</span></span><br><span class="line">  __int128 v17; <span class="comment">// [rsp+60h] [rbp-78h] BYREF</span></span><br><span class="line">  _QWORD v18[<span class="number">13</span>]; <span class="comment">// [rsp+70h] [rbp-68h] BYREF</span></span><br><span class="line"></span><br><span class="line">  v0 = off_7FF7F511D470;</span><br><span class="line">  v17 = <span class="number">0u</span>;</span><br><span class="line">  v1 = <span class="built_in">off_7FF7F511D470</span>();</span><br><span class="line">  *Size = unk_7FF7F511EEA0;</span><br><span class="line">  <span class="built_in">sub_7FF7F510273E</span>(v1, Size);</span><br><span class="line">  result = <span class="built_in">sub_7FF7F510AE60</span>(&amp;qword_7FF7F511D300);</span><br><span class="line">  v3 = result;</span><br><span class="line">  <span class="keyword">if</span> ( *result )</span><br><span class="line">  &#123;</span><br><span class="line">    v7 = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v4 = (v0)(<span class="number">0</span>);</span><br><span class="line">    result = <span class="built_in">sub_7FF7F5103094</span>(Size, v4);</span><br><span class="line">    v5 = Size[<span class="number">1</span>];</span><br><span class="line">    v6 = Size[<span class="number">0</span>];</span><br><span class="line">    v7 = Size[<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">if</span> ( !*v3 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( qword_7FF7F51261D0 != Size[<span class="number">0</span>] || Size[<span class="number">0</span>] &amp;&amp; <span class="built_in">memcmp</span>((Size[<span class="number">1</span>] + <span class="number">8</span>), (qword_7FF7F51261D8 + <span class="number">8</span>), Size[<span class="number">0</span>]) )</span><br><span class="line">      &#123;</span><br><span class="line">        result = <span class="built_in">sub_7FF7F5106F1A</span>(&amp;unk_7FF7F511EDA0, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span> ( *(&amp;v17 + <span class="number">1</span>) &amp;&amp; (*(*(&amp;v17 + <span class="number">1</span>) + <span class="number">7LL</span>) &amp; <span class="number">0x40</span>) == <span class="number">0</span> )</span><br><span class="line">          result = (sub_7FF7F510455D)();</span><br><span class="line">        <span class="keyword">if</span> ( v5 )</span><br><span class="line">        &#123;</span><br><span class="line">          v9 = v5;</span><br><span class="line">          <span class="keyword">if</span> ( (*(v5 + <span class="number">7</span>) &amp; <span class="number">0x40</span>) == <span class="number">0</span> )</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">sub_7FF7F510455D</span>(v9);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">      &#125;</span><br><span class="line">      v15 = unk_7FF7F511EF50;</span><br><span class="line">      v14 = unk_7FF7F511EDE0;</span><br><span class="line">      <span class="built_in">sub_7FF7F5108E3C</span>(Size, &amp;v15, &amp;v14);</span><br><span class="line">      result = Size[<span class="number">0</span>];</span><br><span class="line">      v8 = Size[<span class="number">1</span>];</span><br><span class="line">      <span class="keyword">if</span> ( !*v3 )</span><br><span class="line">      &#123;</span><br><span class="line">        v15 = *Size;</span><br><span class="line">        result = <span class="built_in">sub_7FF7F5107289</span>(Size, &amp;v15);</span><br><span class="line">        v10 = *v3 == <span class="number">0</span>;</span><br><span class="line">        v17 = *Size;</span><br><span class="line">        <span class="keyword">if</span> ( v10 )</span><br><span class="line">        &#123;</span><br><span class="line">          v11 = *(&amp;v17 + <span class="number">1</span>);</span><br><span class="line">          v13 = v17;</span><br><span class="line">          <span class="built_in">sub_7FF7F5106FE1</span>(&amp;v17);</span><br><span class="line">          *(&amp;v14 + <span class="number">1</span>) = v5;</span><br><span class="line">          v15 = __PAIR128__(v11, v13);</span><br><span class="line">          *&amp;v14 = v6;</span><br><span class="line">          <span class="built_in">sub_7FF7F51092ED</span>(Size, &amp;v15, &amp;v14);</span><br><span class="line">          result = Size[<span class="number">0</span>];</span><br><span class="line">          v12 = Size[<span class="number">1</span>];</span><br><span class="line">          <span class="keyword">if</span> ( !*v3 )</span><br><span class="line">          &#123;</span><br><span class="line">            v18[<span class="number">0</span>] = <span class="number">23</span>;</span><br><span class="line">            v18[<span class="number">1</span>] = &amp;unk_7FF7F511EDC0;</span><br><span class="line">            v18[<span class="number">2</span>] = Size[<span class="number">0</span>];</span><br><span class="line">            v18[<span class="number">3</span>] = Size[<span class="number">1</span>];</span><br><span class="line">            result = <span class="built_in">sub_7FF7F5106F1A</span>(v18, <span class="number">2</span>);</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">if</span> ( v12 &amp;&amp; (*(v12 + <span class="number">7</span>) &amp; <span class="number">0x40</span>) == <span class="number">0</span> )</span><br><span class="line">            result = <span class="built_in">sub_7FF7F510455D</span>(v12);</span><br><span class="line">          <span class="keyword">if</span> ( v11 &amp;&amp; (*(v11 + <span class="number">7</span>) &amp; <span class="number">0x40</span>) == <span class="number">0</span> )</span><br><span class="line">            result = <span class="built_in">sub_7FF7F510455D</span>(v11);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> ( v8 &amp;&amp; (*(v8 + <span class="number">7</span>) &amp; <span class="number">0x40</span>) == <span class="number">0</span> )</span><br><span class="line">        result = <span class="built_in">sub_7FF7F510455D</span>(v8);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( *(&amp;v17 + <span class="number">1</span>) &amp;&amp; (*(*(&amp;v17 + <span class="number">1</span>) + <span class="number">7LL</span>) &amp; <span class="number">0x40</span>) == <span class="number">0</span> )</span><br><span class="line">    result = <span class="built_in">sub_7FF7F510455D</span>(*(&amp;v17 + <span class="number">1</span>));</span><br><span class="line">  <span class="keyword">if</span> ( v7 &amp;&amp; (*(v7 + <span class="number">7</span>) &amp; <span class="number">0x40</span>) == <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v9 = v7;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sub_7FF7F510455D</span>(v9);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>This is probably where the input key is checked.</li>
<li>It will check if the input len is equal to 46 combined with the fixed key string.<br><img src="https://hackmd.io/_uploads/Hkby8Yc8xl.png" alt="image"><blockquote>
<p>Key: I’m a very strong key, and you can’t guess me.</p>
</blockquote>
</li>
<li>Try running the program and entering the key.<br><img src="https://hackmd.io/_uploads/Sk7LLt5Ixl.png" alt="image"></li>
<li>As I expected it will do with this key and return flag.<blockquote>
<p>FLAG: HCMUS-CTF{n1mbl3_nlmb1e_nImb!e}</p>
</blockquote>
</li>
</ul>
<h2 id="Reversing-wtdll"><a href="#Reversing-wtdll" class="headerlink" title="Reversing&#x2F;wtdll"></a>Reversing&#x2F;wtdll</h2><ul>
<li>In this challenge I received a folder containing 1000 .dll files and I saw that their sizes were almost the same.<br><img src="https://hackmd.io/_uploads/rkCLJY98lx.png" alt="image"></li>
<li>When I checked some random files, I saw that they all exported the <code>PrintFlag?()</code> function. At this point, I suspect that in these 1000 dll files, there will be a few files that print out each character of the flag.</li>
<li>I will come up with the idea of using a tool to scan through these 1000 .dll files and check if the PrintFlag() function of each file shows any characters.</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> pefile</span><br><span class="line"><span class="keyword">from</span> capstone <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">DLL_DIRECTORY = <span class="string">r&quot;C:\Users\huynh\Downloads\public&quot;</span>  <span class="comment"># Thay bằng đường dẫn thực tế</span></span><br><span class="line">RETURN_VALUES = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">analyze_dll</span>(<span class="params">dll_path, filename</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># Load file DLL</span></span><br><span class="line">        pe = pefile.PE(dll_path, fast_load=<span class="literal">True</span>)</span><br><span class="line">        is_64bit = pe.OPTIONAL_HEADER.Magic == <span class="number">0x20b</span>  <span class="comment"># 0x20b: PE32+, 0x10b: PE32</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        md = Cs(CS_ARCH_X86, CS_MODE_64 <span class="keyword">if</span> is_64bit <span class="keyword">else</span> CS_MODE_32)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        found = <span class="literal">False</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">hasattr</span>(pe, <span class="string">&#x27;DIRECTORY_ENTRY_EXPORT&#x27;</span>):</span><br><span class="line">            <span class="keyword">for</span> exp <span class="keyword">in</span> pe.DIRECTORY_ENTRY_EXPORT.symbols:</span><br><span class="line">                <span class="keyword">if</span> exp.name <span class="keyword">and</span> exp.name.decode(errors=<span class="string">&#x27;ignore&#x27;</span>) == <span class="string">&quot;PrintFlag&quot;</span>:</span><br><span class="line">                    func_rva = exp.address</span><br><span class="line">                    func_offset = pe.get_offset_from_rva(func_rva)</span><br><span class="line">                    code = pe.get_memory_mapped_image()[func_offset:func_offset+<span class="number">64</span>]</span><br><span class="line">                    analyze_function(code, func_rva, md, dll_path, filename)</span><br><span class="line">                    found = <span class="literal">True</span></span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> found:</span><br><span class="line">            <span class="keyword">for</span> section <span class="keyword">in</span> pe.sections:</span><br><span class="line">                <span class="keyword">if</span> <span class="string">b&#x27;.text&#x27;</span> <span class="keyword">in</span> section.Name:</span><br><span class="line">                    code = section.get_data()</span><br><span class="line">                    code_rva = section.VirtualAddress</span><br><span class="line">                    analyze_function(code, code_rva, md, dll_path, filename)</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Error analyzing <span class="subst">&#123;dll_path&#125;</span>: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">analyze_function</span>(<span class="params">code, base_addr, md, dll_path, filename</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">for</span> insn <span class="keyword">in</span> md.disasm(code, base_addr):</span><br><span class="line">            <span class="keyword">if</span> insn.mnemonic == <span class="string">&quot;ret&quot;</span>:</span><br><span class="line">                prev_insns = <span class="built_in">list</span>(md.disasm(code[:insn.address - base_addr], base_addr))</span><br><span class="line">                <span class="keyword">for</span> prev_insn <span class="keyword">in</span> <span class="built_in">reversed</span>(prev_insns):</span><br><span class="line">                    <span class="keyword">if</span> prev_insn.mnemonic == <span class="string">&quot;mov&quot;</span> <span class="keyword">and</span> (<span class="string">&quot;rax&quot;</span> <span class="keyword">in</span> prev_insn.op_str <span class="keyword">or</span> <span class="string">&quot;eax&quot;</span> <span class="keyword">in</span> prev_insn.op_str):</span><br><span class="line">                        <span class="keyword">try</span>:</span><br><span class="line">                            value = <span class="built_in">int</span>(prev_insn.op_str.split(<span class="string">&quot;,&quot;</span>)[<span class="number">1</span>].strip(), <span class="number">0</span>)</span><br><span class="line">                            <span class="keyword">if</span> value != <span class="number">0</span>:</span><br><span class="line">                                RETURN_VALUES.append((filename, value))</span><br><span class="line">                                <span class="built_in">print</span>(<span class="string">f&quot;Found return value <span class="subst">&#123;value&#125;</span> in <span class="subst">&#123;dll_path&#125;</span>&quot;</span>)</span><br><span class="line">                            <span class="keyword">break</span></span><br><span class="line">                        <span class="keyword">except</span> ValueError:</span><br><span class="line">                            <span class="keyword">break</span></span><br><span class="line">                    <span class="keyword">elif</span> prev_insn.mnemonic == <span class="string">&quot;ret&quot;</span>:</span><br><span class="line">                        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Error disassembling in <span class="subst">&#123;dll_path&#125;</span>: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line"></span><br><span class="line">    dll_files = [f <span class="keyword">for</span> f <span class="keyword">in</span> os.listdir(DLL_DIRECTORY) <span class="keyword">if</span> f.endswith(<span class="string">&quot;.dll&quot;</span>)]</span><br><span class="line">    total_files = <span class="built_in">len</span>(dll_files)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    dll_files.sort(key=<span class="keyword">lambda</span> x: <span class="built_in">int</span>(<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">filter</span>(<span class="built_in">str</span>.isdigit, x))) <span class="keyword">if</span> <span class="built_in">any</span>(c.isdigit() <span class="keyword">for</span> c <span class="keyword">in</span> x) <span class="keyword">else</span> x)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i, filename <span class="keyword">in</span> <span class="built_in">enumerate</span>(dll_files, <span class="number">1</span>):</span><br><span class="line">        dll_path = os.path.join(DLL_DIRECTORY, filename)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Analyzing <span class="subst">&#123;filename&#125;</span> (<span class="subst">&#123;i&#125;</span>/<span class="subst">&#123;total_files&#125;</span>)...&quot;</span>)</span><br><span class="line">        analyze_dll(dll_path, filename)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\nCác giá trị trả về khác 0 từ hàm PrintFlag() (theo thứ tự DLL):&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> RETURN_VALUES:</span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>([(filename, value) <span class="keyword">for</span> filename, value <span class="keyword">in</span> RETURN_VALUES])</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            flag = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(value) <span class="keyword">for</span> _, value <span class="keyword">in</span> RETURN_VALUES <span class="keyword">if</span> <span class="number">32</span> &lt;= value &lt;= <span class="number">126</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Chuỗi flag ghép từ các giá trị (ASCII, theo thứ tự DLL):&quot;</span>, flag)</span><br><span class="line">            <span class="comment"># Nếu flag có dạng HCMUS-CTF&#123;...&#125;</span></span><br><span class="line">            <span class="keyword">if</span> flag.startswith(<span class="string">&quot;HCMUS&quot;</span>):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;Flag hoàn chỉnh:&quot;</span>, <span class="string">f&quot;HCMUS-CTF&#123;&#123;<span class="subst">&#123;flag[<span class="number">5</span>:]&#125;</span>&#125;&#125;&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span> ValueError <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Không thể ghép thành chuỗi ASCII:&quot;</span>, e)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Không tìm thấy giá trị trả về nào khác 0. Kiểm tra lại đường dẫn hoặc cấu trúc hàm.&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line"></span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<blockquote>
<p>FLAG: HCMUS-CTF{m4K3*|)lL_m0r3_f|*|nNY}</p>
</blockquote>
<h2 id="Reversing-Finesse"><a href="#Reversing-Finesse" class="headerlink" title="Reversing&#x2F;Finesse"></a>Reversing&#x2F;Finesse</h2><ul>
<li><p>The challenge is in the form of a GamePDF like this Tetris in a PDF I found a POC on the internet:<br><a target="_blank" rel="noopener" href="https://th0mas.nl/2025/01/12/tetris-in-a-pdf/?fbclid=IwY2xjawLpxR5leHRuA2FlbQIxMABicmlkETFzQjJGWktUVzNtYzVSQks3AR6y8DGBf4WdbmKgJUzzuTOFZWD4uQHH9ADujcJg4hK_xteaJbM0Rzs2hVy62A_aem_cjp2ATb4aiuFHFw7TpFzwA">https://th0mas.nl/2025/01/12/tetris-in-a-pdf/?fbclid=IwY2xjawLpxR5leHRuA2FlbQIxMABicmlkETFzQjJGWktUVzNtYzVSQks3AR6y8DGBf4WdbmKgJUzzuTOFZWD4uQHH9ADujcJg4hK_xteaJbM0Rzs2hVy62A_aem_cjp2ATb4aiuFHFw7TpFzwA</a></p>
</li>
<li><p>And the source code can be taken and built on this POC.</p>
</li>
<li><p>So I need to know the .js source code hidden in this PDF, I will extract <code>main.pdf</code> using <code>pdf-parser</code>, I will get the hidden .js source code hidden in the PDF.</p>
</li>
<li><p>This is the .js source code after I extracted it.</p>
</li>
<li><p>And because it is quite long, I will give the main code when the condition is met, call the flag string alert function.</p>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">stream</span><br><span class="line"><span class="keyword">const</span> a=<span class="number">10</span>;<span class="keyword">const</span> b=<span class="number">20</span>;<span class="keyword">var</span> c=&#123;<span class="number">0</span>:[<span class="string">&quot;RGB&quot;</span>,<span class="number">1.0</span>,<span class="number">1.0</span>,<span class="number">0.0</span>],<span class="number">1</span>:[<span class="string">&quot;RGB&quot;</span>,<span class="number">0.0</span>,<span class="number">1.0</span>,<span class="number">1.0</span>],<span class="number">2</span>:[<span class="string">&quot;RGB&quot;</span>,<span class="number">0.0</span>,<span class="number">1.0</span>,<span class="number">0.0</span>],<span class="number">3</span>:[<span class="string">&quot;RGB&quot;</span>,<span class="number">1.0</span>,<span class="number">0.0</span>,<span class="number">0.0</span>],<span class="number">4</span>:[<span class="string">&quot;RGB&quot;</span>,<span class="number">1.0</span>,<span class="number">0.5</span>,<span class="number">0.0</span>],<span class="number">5</span>:[<span class="string">&quot;RGB&quot;</span>,<span class="number">0.0</span>,<span class="number">0.0</span>,<span class="number">1.0</span>],<span class="number">6</span>:[<span class="string">&quot;RGB&quot;</span>,<span class="number">0.6</span>,<span class="number">0.0</span>,<span class="number">0.6</span>]&#125;;<span class="keyword">function</span> <span class="title function_">d</span>(<span class="params">e,f</span>)&#123;<span class="keyword">return</span> app.<span class="built_in">setInterval</span>(<span class="string">&quot;(&quot;</span>+e.<span class="title function_">toString</span>()+<span class="string">&quot;)();&quot;</span>,f);&#125;<span class="keyword">var</span> g=<span class="title class_">Date</span>.<span class="title function_">now</span>()%<span class="number">2147483647</span>;<span class="keyword">function</span> <span class="title function_">h</span>(<span class="params"></span>)&#123;<span class="keyword">return</span> g=g*<span class="number">16807</span>%<span class="number">2147483647</span>;&#125;<span class="keyword">var</span> i=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">4</span>,<span class="number">4</span>];<span class="keyword">var</span> j=[<span class="number">0</span>,<span class="number">0</span>,-<span class="number">1</span>,<span class="number">0</span>,-<span class="number">1</span>,-<span class="number">1</span>,<span class="number">0</span>,-<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,-<span class="number">2</span>,<span class="number">0</span>,-<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,-<span class="number">1</span>,<span class="number">0</span>,-<span class="number">2</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,-<span class="number">1</span>,-<span class="number">1</span>,<span class="number">0</span>,-<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,-<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,-<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,-<span class="number">1</span>,<span class="number">1</span>,-<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,-<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,-<span class="number">1</span>,<span class="number">0</span>,-<span class="number">1</span>,-<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,-<span class="number">1</span>,<span class="number">1</span>,-<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,-<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,-<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,-<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,-<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,-<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,-<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,-<span class="number">1</span>,<span class="number">1</span>,-<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,-<span class="number">1</span>,-<span class="number">1</span>,-<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,-<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,-<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,-<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,-<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,-<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,-<span class="number">1</span>];<span class="keyword">var</span> k=<span class="number">50</span>;<span class="keyword">var</span> l=<span class="number">400</span>;<span class="keyword">var</span> m=[];<span class="keyword">var</span> n=[];<span class="keyword">var</span> o=<span class="number">0</span>;<span class="keyword">var</span> p=<span class="number">0</span>;<span class="keyword">var</span> q=<span class="number">0</span>;<span class="keyword">var</span> r=<span class="number">0</span>;<span class="keyword">var</span> s=[];<span class="keyword">var</span> t=<span class="number">0</span>;<span class="keyword">var</span> u=<span class="literal">false</span>;<span class="keyword">var</span> v=<span class="literal">false</span>;<span class="keyword">var</span> w=<span class="title function_">h</span>()%<span class="number">7</span>;<span class="keyword">var</span> x=<span class="number">0</span>;<span class="keyword">var</span> y=<span class="number">0</span>;<span class="keyword">var</span> z=<span class="number">0</span>;<span class="keyword">function</span> <span class="title function_">aa</span>(<span class="params"></span>)&#123;w=<span class="title function_">h</span>()%<span class="number">7</span>;x=<span class="number">4</span>;y=<span class="number">0</span>;z=<span class="number">0</span>;<span class="keyword">for</span>(<span class="keyword">var</span> ab=<span class="number">0</span>;ab&lt;<span class="number">4</span>;++ab)&#123;<span class="keyword">var</span> ac=j[w*<span class="number">32</span>+z*<span class="number">8</span>+ab*<span class="number">2</span>];<span class="keyword">var</span> ad=j[w*<span class="number">32</span>+z*<span class="number">8</span>+ab*<span class="number">2</span>+<span class="number">1</span>];<span class="keyword">var</span> ae=x+ac;<span class="keyword">var</span> af=y+ad;<span class="keyword">if</span>(ae&gt;=<span class="number">0</span>&amp;&amp;ae&lt;a&amp;&amp;af&gt;=<span class="number">0</span>&amp;&amp;af&lt;b)&#123;<span class="keyword">if</span>(n[ae][af]!==<span class="number">0</span>)&#123;<span class="title function_">an</span>();<span class="keyword">return</span> <span class="literal">false</span>;&#125;&#125;&#125;<span class="keyword">return</span> <span class="literal">true</span>;&#125;<span class="keyword">function</span> <span class="title function_">ag</span>(<span class="params">ah</span>)&#123;<span class="variable language_">this</span>.<span class="title function_">getField</span>(<span class="string">&quot;T_input&quot;</span>).<span class="property">hidden</span>=!ah;<span class="variable language_">this</span>.<span class="title function_">getField</span>(<span class="string">&quot;B_left&quot;</span>).<span class="property">hidden</span>=!ah;<span class="variable language_">this</span>.<span class="title function_">getField</span>(<span class="string">&quot;B_right&quot;</span>).<span class="property">hidden</span>=!ah;<span class="variable language_">this</span>.<span class="title function_">getField</span>(<span class="string">&quot;B_down&quot;</span>).<span class="property">hidden</span>=!ah;<span class="variable language_">this</span>.<span class="title function_">getField</span>(<span class="string">&quot;B_rotate&quot;</span>).<span class="property">hidden</span>=!ah;&#125;<span class="keyword">function</span> <span class="title function_">ai</span>(<span class="params"></span>)&#123;<span class="keyword">for</span>(<span class="keyword">var</span> aj=<span class="number">0</span>;aj&lt;a;++aj)&#123;m[aj]=[];n[aj]=[];<span class="keyword">for</span>(<span class="keyword">var</span> ak=<span class="number">0</span>;ak&lt;b;++ak)&#123;m[aj][ak]=<span class="variable language_">this</span>.<span class="title function_">getField</span>(<span class="string">`P_<span class="subst">$&#123;aj&#125;</span>_<span class="subst">$&#123;ak&#125;</span>`</span>);n[aj][ak]=<span class="number">0</span>;&#125;&#125;<span class="title function_">aa</span>();q=p;o=<span class="number">0</span>;u=<span class="literal">true</span>;r=<span class="title function_">d</span>(cz,k);<span class="variable language_">this</span>.<span class="title function_">getField</span>(<span class="string">&quot;B_start&quot;</span>).<span class="property">hidden</span>=<span class="literal">true</span>;<span class="title function_">ag</span>(<span class="literal">true</span>);&#125;<span class="keyword">function</span> <span class="title function_">al</span>(<span class="params"></span>)&#123;<span class="keyword">var</span> am=<span class="literal">true</span>;<span class="keyword">if</span>(p-q&gt;=l)&#123;am=<span class="title function_">bv</span>();q=p;&#125;<span class="keyword">return</span> am;&#125;<span class="keyword">function</span> <span class="title function_">an</span>(<span class="params"></span>)&#123;u=<span class="literal">false</span>;app.<span class="built_in">clearInterval</span>(r);<span class="keyword">for</span>(<span class="keyword">var</span> ao=<span class="number">0</span>;ao&lt;a;++ao)&#123;<span class="keyword">for</span>(<span class="keyword">var</span> ap=<span class="number">0</span>;ap&lt;b;++ap)&#123;m[ao][ap].<span class="property">fillColor</span>=color.<span class="property">black</span>;m[ao][ap].<span class="property">hidden</span>=<span class="literal">false</span>;&#125;&#125;app.<span class="title function_">alert</span>(<span class="string">`Game over! Score: <span class="subst">$&#123;o&#125;</span>\nRefresh to restart.`</span>);&#125;<span class="keyword">function</span> <span class="title function_">aq</span>(<span class="params">ar</span>)&#123;<span class="keyword">if</span>(ar===<span class="number">1</span>)&#123;<span class="keyword">return</span>[[<span class="number">0</span>,<span class="number">0</span>],[<span class="number">1</span>,<span class="number">0</span>],[-<span class="number">1</span>,<span class="number">0</span>],[<span class="number">2</span>,<span class="number">0</span>],[-<span class="number">2</span>,<span class="number">0</span>],[<span class="number">0</span>,-<span class="number">1</span>],[<span class="number">1</span>,-<span class="number">1</span>],[-<span class="number">1</span>,-<span class="number">1</span>],[<span class="number">0</span>,-<span class="number">2</span>]];&#125;<span class="keyword">else</span>&#123;<span class="keyword">return</span>[[<span class="number">0</span>,<span class="number">0</span>],[<span class="number">1</span>,<span class="number">0</span>],[-<span class="number">1</span>,<span class="number">0</span>],[<span class="number">0</span>,-<span class="number">1</span>],[<span class="number">1</span>,-<span class="number">1</span>],[-<span class="number">1</span>,-<span class="number">1</span>],[<span class="number">0</span>,-<span class="number">2</span>]];&#125;&#125;<span class="keyword">function</span> <span class="title function_">as</span>(<span class="params"></span>)&#123;<span class="keyword">if</span>(!u)<span class="keyword">return</span>;t+=<span class="number">1</span>;<span class="keyword">var</span> at=z;<span class="keyword">var</span> au=(z+<span class="number">1</span>)%i[w];<span class="keyword">var</span> av=<span class="title function_">aq</span>(w);<span class="keyword">for</span>(<span class="keyword">var</span> aw=<span class="number">0</span>;aw&lt;av.<span class="property">length</span>;aw++)&#123;<span class="keyword">var</span> ax=av[aw][<span class="number">0</span>];<span class="keyword">var</span> ay=av[aw][<span class="number">1</span>];<span class="keyword">var</span> az=<span class="literal">true</span>;<span class="keyword">for</span>(<span class="keyword">var</span> ba=<span class="number">0</span>;ba&lt;<span class="number">4</span>;++ba)&#123;<span class="keyword">var</span> bb=j[w*<span class="number">32</span>+au*<span class="number">8</span>+ba*<span class="number">2</span>];<span class="keyword">var</span> bc=j[w*<span class="number">32</span>+au*<span class="number">8</span>+ba*<span class="number">2</span>+<span class="number">1</span>];<span class="keyword">var</span> bd=x+bb+ax;<span class="keyword">var</span> be=y+bc+ay;<span class="keyword">if</span>(bd&lt;<span class="number">0</span>||bd&gt;=a||be&lt;<span class="number">0</span>||be&gt;=b||n[bd][be]!==<span class="number">0</span>)&#123;az=<span class="literal">false</span>;<span class="keyword">break</span>;&#125;&#125;<span class="keyword">if</span>(az)&#123;z=au;x+=ax;y+=ay;<span class="keyword">return</span>;&#125;&#125;&#125;<span class="keyword">function</span> <span class="title function_">bf</span>(<span class="params"></span>)&#123;<span class="keyword">if</span>(!u)<span class="keyword">return</span>;t+=<span class="number">2</span>;x--;<span class="keyword">if</span>(<span class="title function_">bh</span>())x++;&#125;<span class="keyword">function</span> <span class="title function_">bg</span>(<span class="params"></span>)&#123;<span class="keyword">if</span>(!u)<span class="keyword">return</span>;t+=<span class="number">3</span>;x++;<span class="keyword">if</span>(<span class="title function_">bh</span>())x--;&#125;<span class="keyword">function</span> <span class="title function_">bh</span>(<span class="params"></span>)&#123;<span class="keyword">for</span>(<span class="keyword">var</span> bi=<span class="number">0</span>;bi&lt;<span class="number">4</span>;++bi)&#123;<span class="keyword">var</span> bj=j[w*<span class="number">32</span>+z*<span class="number">8</span>+bi*<span class="number">2</span>];<span class="keyword">var</span> bk=j[w*<span class="number">32</span>+z*<span class="number">8</span>+bi*<span class="number">2</span>+<span class="number">1</span>];<span class="keyword">var</span> bl=x+bj;<span class="keyword">var</span> bm=y+bk;<span class="keyword">if</span>(bl&lt;<span class="number">0</span>||bl&gt;=a||n[bl][bm])<span class="keyword">return</span> <span class="literal">true</span>;&#125;<span class="keyword">return</span> <span class="literal">false</span>;&#125;<span class="keyword">function</span> <span class="title function_">bn</span>(<span class="params">bo</span>)&#123;<span class="keyword">if</span>(!u)<span class="keyword">return</span>;<span class="keyword">switch</span>(bo.<span class="property">change</span>)&#123;<span class="keyword">case</span><span class="string">&#x27;w&#x27;</span>:<span class="title function_">as</span>();<span class="keyword">break</span>;<span class="keyword">case</span><span class="string">&#x27;a&#x27;</span>:<span class="title function_">bf</span>();<span class="keyword">break</span>;<span class="keyword">case</span><span class="string">&#x27;d&#x27;</span>:<span class="title function_">bg</span>();<span class="keyword">break</span>;<span class="keyword">case</span><span class="string">&#x27;s&#x27;</span>:<span class="title function_">bv</span>();<span class="keyword">break</span>;<span class="keyword">case</span><span class="string">&#x27; &#x27;</span>:<span class="title function_">cc</span>();<span class="keyword">break</span>;&#125;&#125;<span class="keyword">function</span> <span class="title function_">bp</span>(<span class="params"></span>)&#123;<span class="keyword">for</span>(<span class="keyword">var</span> bq=<span class="number">0</span>;bq&lt;b;++bq)&#123;<span class="keyword">var</span> br=<span class="literal">true</span>;<span class="keyword">for</span>(<span class="keyword">var</span> bs=<span class="number">0</span>;bs&lt;a;++bs)&#123;<span class="keyword">if</span>(n[bs][bq]===<span class="number">0</span>)&#123;br=<span class="literal">false</span>;<span class="keyword">break</span>;&#125;&#125;<span class="keyword">if</span>(br)&#123;o++;<span class="title function_">cj</span>();<span class="keyword">for</span>(<span class="keyword">var</span> bt=bq;bt&gt;<span class="number">0</span>;--bt)&#123;<span class="keyword">for</span>(<span class="keyword">var</span> bu=<span class="number">0</span>;bu&lt;a;++bu)&#123;n[bu][bt]=n[bu][bt-<span class="number">1</span>];&#125;&#125;<span class="keyword">for</span>(<span class="keyword">var</span> bu=<span class="number">0</span>;bu&lt;a;++bu)&#123;n[bu][<span class="number">0</span>]=<span class="number">0</span>;&#125;bq--;&#125;&#125;&#125;<span class="keyword">function</span> <span class="title function_">bv</span>(<span class="params"></span>)&#123;<span class="keyword">var</span> bw=<span class="literal">false</span>;y++;<span class="keyword">for</span>(<span class="keyword">var</span> bx=<span class="number">0</span>;bx&lt;<span class="number">4</span>;++bx)&#123;<span class="keyword">var</span> by=j[w*<span class="number">32</span>+z*<span class="number">8</span>+bx*<span class="number">2</span>];<span class="keyword">var</span> bz=j[w*<span class="number">32</span>+z*<span class="number">8</span>+bx*<span class="number">2</span>+<span class="number">1</span>];<span class="keyword">var</span> ca=x+by;<span class="keyword">var</span> cb=y+bz;<span class="keyword">if</span>(ca&lt;<span class="number">0</span>||cb&lt;<span class="number">0</span>||ca&gt;=a||cb&gt;=b||n[ca][cb])&#123;bw=<span class="literal">true</span>;<span class="keyword">break</span>;&#125;&#125;<span class="keyword">if</span>(bw)&#123;y--;<span class="keyword">for</span>(<span class="keyword">var</span> bx=<span class="number">0</span>;bx&lt;<span class="number">4</span>;++bx)&#123;<span class="keyword">var</span> by=j[w*<span class="number">32</span>+z*<span class="number">8</span>+bx*<span class="number">2</span>];<span class="keyword">var</span> bz=j[w*<span class="number">32</span>+z*<span class="number">8</span>+bx*<span class="number">2</span>+<span class="number">1</span>];<span class="keyword">var</span> ca=x+by;<span class="keyword">var</span> cb=y+bz;<span class="keyword">if</span>(cb&lt;<span class="number">0</span>)&#123;<span class="title function_">an</span>();<span class="keyword">return</span> <span class="literal">false</span>;&#125;&#125;<span class="keyword">for</span>(<span class="keyword">var</span> bx=<span class="number">0</span>;bx&lt;<span class="number">4</span>;++bx)&#123;<span class="keyword">var</span> by=j[w*<span class="number">32</span>+z*<span class="number">8</span>+bx*<span class="number">2</span>];<span class="keyword">var</span> bz=j[w*<span class="number">32</span>+z*<span class="number">8</span>+bx*<span class="number">2</span>+<span class="number">1</span>];<span class="keyword">var</span> ca=x+by;<span class="keyword">var</span> cb=y+bz;n[ca][cb]=w+<span class="number">1</span>;&#125;<span class="title function_">bp</span>();s.<span class="title function_">push</span>(t%<span class="number">32</span>);t=<span class="number">0</span>;<span class="title function_">da</span>();<span class="keyword">return</span> <span class="title function_">aa</span>();&#125;<span class="keyword">return</span> <span class="literal">true</span>;&#125;<span class="keyword">function</span> <span class="title function_">cc</span>(<span class="params"></span>)&#123;<span class="keyword">while</span>(<span class="literal">true</span>)&#123;y++;<span class="keyword">var</span> cd=<span class="literal">false</span>;<span class="keyword">for</span>(<span class="keyword">var</span> ce=<span class="number">0</span>;ce&lt;<span class="number">4</span>;++ce)&#123;<span class="keyword">var</span> cf=j[w*<span class="number">32</span>+z*<span class="number">8</span>+ce*<span class="number">2</span>];<span class="keyword">var</span> cg=j[w*<span class="number">32</span>+z*<span class="number">8</span>+ce*<span class="number">2</span>+<span class="number">1</span>];<span class="keyword">var</span> ch=x+cf;<span class="keyword">var</span> ci=y+cg;<span class="keyword">if</span>(ch&lt;<span class="number">0</span>||ci&lt;<span class="number">0</span>||ch&gt;=a||ci&gt;=b||n[ch][ci])&#123;cd=<span class="literal">true</span>;<span class="keyword">break</span>;&#125;&#125;<span class="keyword">if</span>(cd)&#123;y--;<span class="title function_">bv</span>();<span class="keyword">break</span>;&#125;&#125;&#125;<span class="keyword">function</span> <span class="title function_">cj</span>(<span class="params"></span>)&#123;<span class="keyword">if</span>(v)<span class="keyword">return</span>;<span class="variable language_">this</span>.<span class="title function_">getField</span>(<span class="string">&quot;T_score&quot;</span>).<span class="property">value</span>=<span class="string">`Score: <span class="subst">$&#123;o&#125;</span>`</span>;&#125;<span class="keyword">function</span> <span class="title function_">ck</span>(<span class="params">cl,cm,cn</span>)&#123;<span class="keyword">if</span>(cl&lt;<span class="number">0</span>||cm&lt;<span class="number">0</span>||cl&gt;=a||cm&gt;=b)<span class="keyword">return</span>;<span class="keyword">var</span> co=m[cl][b-<span class="number">1</span>-cm];<span class="keyword">if</span>(cn)&#123;co.<span class="property">hidden</span>=<span class="literal">false</span>;co.<span class="property">fillColor</span>=c[cn-<span class="number">1</span>];&#125;<span class="keyword">else</span>&#123;co.<span class="property">hidden</span>=<span class="literal">true</span>;co.<span class="property">fillColor</span>=color.<span class="property">transparent</span>;&#125;&#125;<span class="keyword">function</span> <span class="title function_">cp</span>(<span class="params"></span>)&#123;<span class="keyword">for</span>(<span class="keyword">var</span> cq=<span class="number">0</span>;cq&lt;a;++cq)&#123;<span class="keyword">for</span>(<span class="keyword">var</span> cr=<span class="number">0</span>;cr&lt;b;++cr)&#123;<span class="title function_">ck</span>(cq,cr,n[cq][cr]);&#125;&#125;&#125;<span class="keyword">function</span> <span class="title function_">cs</span>(<span class="params"></span>)&#123;<span class="keyword">for</span>(<span class="keyword">var</span> ct=<span class="number">0</span>;ct&lt;<span class="number">4</span>;++ct)&#123;<span class="keyword">var</span> cu=j[w*<span class="number">32</span>+z*<span class="number">8</span>+ct*<span class="number">2</span>];<span class="keyword">var</span> cv=j[w*<span class="number">32</span>+z*<span class="number">8</span>+ct*<span class="number">2</span>+<span class="number">1</span>];<span class="keyword">var</span> cw=x+cu;<span class="keyword">var</span> cx=y+cv;<span class="title function_">ck</span>(cw,cx,w+<span class="number">1</span>);&#125;&#125;<span class="keyword">function</span> <span class="title function_">cy</span>(<span class="params"></span>)&#123;<span class="title function_">cp</span>();<span class="title function_">cs</span>();&#125;<span class="keyword">function</span> <span class="title function_">cz</span>(<span class="params"></span>)&#123;<span class="keyword">if</span>(!u)<span class="keyword">return</span>;p+=k;<span class="keyword">if</span>(<span class="title function_">al</span>())<span class="title function_">cy</span>();&#125;<span class="keyword">function</span> <span class="title function_">da</span>(<span class="params"></span>)&#123;<span class="keyword">var</span> db=s.<span class="property">length</span>-<span class="number">1</span>;<span class="keyword">for</span>(<span class="keyword">var</span> dc=<span class="number">0</span>;dc&lt;<span class="number">129</span>;dc++)&#123;<span class="keyword">var</span> dd=<span class="built_in">parseInt</span>(<span class="variable language_">this</span>.<span class="title function_">getField</span>(<span class="string">`M_<span class="subst">$&#123;dc&#125;</span>`</span>).<span class="property">value</span>);<span class="keyword">var</span> de=<span class="built_in">parseInt</span>(<span class="variable language_">this</span>.<span class="title function_">getField</span>(<span class="string">`M_<span class="subst">$&#123;dc&#125;</span>_<span class="subst">$&#123;db&#125;</span>`</span>).<span class="property">value</span>);<span class="variable language_">this</span>.<span class="title function_">getField</span>(<span class="string">`M_<span class="subst">$&#123;dc&#125;</span>`</span>).<span class="property">value</span>=dd+de*s[db];&#125;<span class="keyword">if</span>(db==<span class="number">128</span>)&#123;<span class="keyword">for</span>(<span class="keyword">var</span> dc=<span class="number">0</span>;dc&lt;<span class="number">129</span>;dc++)&#123;<span class="keyword">if</span>(<span class="variable language_">this</span>.<span class="title function_">getField</span>(<span class="string">`M_<span class="subst">$&#123;dc&#125;</span>`</span>).<span class="property">value</span>!=<span class="variable language_">this</span>.<span class="title function_">getField</span>(<span class="string">`G_<span class="subst">$&#123;dc&#125;</span>`</span>).<span class="property">value</span>)&#123;s=[];<span class="keyword">return</span>;&#125;&#125;<span class="title function_">df</span>();&#125;&#125;<span class="keyword">function</span> <span class="title function_">df</span>(<span class="params"></span>)&#123;u=<span class="literal">false</span>;v=<span class="literal">true</span>;<span class="keyword">var</span> dg=<span class="string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!\&quot;#$%&amp;&#x27;()*+,-./:;&lt;=&gt;?@[\\]^_`&#123;|&#125;~&quot;</span>;<span class="keyword">var</span> dh=<span class="string">&quot;&quot;</span>;<span class="keyword">for</span>(<span class="keyword">var</span> di=<span class="number">0</span>;di&lt;s.<span class="property">length</span>/<span class="number">3</span>;di++)&#123;dh+=dg[s[<span class="number">3</span>*di]+s[<span class="number">3</span>*di+<span class="number">1</span>]+s[<span class="number">3</span>*di+<span class="number">2</span>]];&#125;app.<span class="title function_">alert</span>(<span class="string">`<span class="subst">$&#123;dh&#125;</span>`</span>);&#125;<span class="title function_">ag</span>(<span class="literal">false</span>);app.<span class="title function_">execMenuItem</span>(<span class="string">&quot;FitPage&quot;</span>);</span><br><span class="line">endstream</span><br><span class="line">endobj</span><br></pre></td></tr></table></figure>

<ul>
<li><p>Here, when the condition is met, the flag will be created based on the character mapping method by index in the string.<br><code>dg=&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!\&quot;#$%&amp;&#39;()*+,-./:;&lt;=&gt;?@[\\]^_</code>{|}~”&#96;</p>
</li>
<li><p>And the index is calculated as follows:</p>
<blockquote>
<p><code>index = G_x / M_x_y</code></p>
</blockquote>
</li>
<li><p>And the M and G values are available in the .js source extracted above.</p>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">/<span class="title class_">Subtype</span> /<span class="title class_">Widget</span></span><br><span class="line">  /<span class="title function_">T</span> (<span class="variable constant_">G_0</span>)</span><br><span class="line">  /<span class="title class_">Type</span> /<span class="title class_">Annot</span></span><br><span class="line">  /<span class="title function_">V</span> (<span class="number">24006</span>)</span><br><span class="line">&gt;&gt;</span><br><span class="line">endobj</span><br></pre></td></tr></table></figure>

<ul>
<li>For example, here is the value<code>G_0 = 24006</code></li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/<span class="title class_">Subtype</span> /<span class="title class_">Widget</span></span><br><span class="line">  /<span class="title function_">T</span> (<span class="variable constant_">M_0_0</span>)</span><br><span class="line">  /<span class="title class_">Type</span> /<span class="title class_">Annot</span></span><br><span class="line">  /<span class="title function_">V</span> (<span class="number">602</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>For example, here the value <code>M_0_0 = 602</code></li>
<li>Because it is too long, I asked AI to write a python script to extract the 2 values into 2 files <code>M.txt</code> and <code>G.txt</code></li>
<li>Finally, I rebuilt the function that generates the index and map flag.</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">dg = <span class="string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!\&quot;#$%&amp;&#x27;()*+,-./:;&lt;=&gt;?@[\\]^_`&#123;|&#125;~&quot;</span></span><br><span class="line"></span><br><span class="line">M = np.zeros((<span class="number">129</span>, <span class="number">129</span>), dtype=np.float64)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;M.txt&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> f:</span><br><span class="line">        m = re.<span class="keyword">match</span>(<span class="string">r&quot;M_(\d+)_(\d+)\s*=\s*(-?\d+)&quot;</span>, line)</span><br><span class="line">        <span class="keyword">if</span> m:</span><br><span class="line">            i, j, v = <span class="built_in">map</span>(<span class="built_in">int</span>, m.groups())</span><br><span class="line">            <span class="keyword">if</span> i &lt; <span class="number">129</span> <span class="keyword">and</span> j &lt; <span class="number">129</span>:</span><br><span class="line">                M[i][j] = v</span><br><span class="line"></span><br><span class="line">G = np.zeros(<span class="number">129</span>, dtype=np.float64)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;G.txt&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> f:</span><br><span class="line">        m = re.<span class="keyword">match</span>(<span class="string">r&quot;G_(\d+)\s*=\s*(-?\d+)&quot;</span>, line)</span><br><span class="line">        <span class="keyword">if</span> m:</span><br><span class="line">            i, v = <span class="built_in">map</span>(<span class="built_in">int</span>, m.groups())</span><br><span class="line">            <span class="keyword">if</span> i &lt; <span class="number">129</span>:</span><br><span class="line">                G[i] = v</span><br><span class="line"></span><br><span class="line">s_real = np.linalg.solve(M, G)  <span class="comment"># Hệ vuông 129x129</span></span><br><span class="line"></span><br><span class="line">s = np.<span class="built_in">round</span>(s_real).astype(<span class="built_in">int</span>) % <span class="number">32</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Giải mã flag</span></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(s), <span class="number">3</span>):</span><br><span class="line">    <span class="keyword">if</span> i + <span class="number">2</span> &lt; <span class="built_in">len</span>(s):</span><br><span class="line">        idx = s[i] + s[i+<span class="number">1</span>] + s[i+<span class="number">2</span>]</span><br><span class="line">        flag += dg[idx % <span class="built_in">len</span>(dg)]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot; Flag:&quot;</span>, flag)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>FLAG: HCMUS-CTF{w0w_u_r3a11y_r_4_T4Tr15_g0d_huh?}</p>
</blockquote>
<h2 id="Reversing-Hide-and-Seek"><a href="#Reversing-Hide-and-Seek" class="headerlink" title="Reversing&#x2F;Hide and Seek"></a>Reversing&#x2F;Hide and Seek</h2><ul>
<li>In this challenge, I looked through and saw that there were many error-causing parts that prevented IDA from compiling the main function.<br><img src="https://hackmd.io/_uploads/HJiPZ_58xx.png" alt="image"></li>
<li>Here <code>jnz</code> and <code>jz</code> are both jumped to the same label <code>loc_</code> I will patch the file instead of using <code>jz </code> and <code>jnz</code> at the same time I will use a <code>jmp</code> command.</li>
<li>I will path all these command pairs in the file and reload.</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">main</span><span class="params">(<span class="type">int</span> a1, <span class="type">char</span> **a2, <span class="type">char</span> **a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+1Ch] [rbp-54h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v5; <span class="comment">// [rsp+2Ch] [rbp-44h]</span></span><br><span class="line">  _BYTE v6[<span class="number">56</span>]; <span class="comment">// [rsp+30h] [rbp-40h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v7; <span class="comment">// [rsp+68h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v7 = __readfsqword(<span class="number">0x28u</span>);</span><br><span class="line">  <span class="built_in">signal</span>(<span class="number">8</span>, handler);</span><br><span class="line">  qword_7958 = *a2;</span><br><span class="line">  <span class="keyword">if</span> ( dword_7934 &amp;&amp; (a1 &lt;= <span class="number">1</span> || *a2[<span class="number">1</span>] != <span class="number">108</span> || a2[<span class="number">1</span>][<span class="number">1</span>] != <span class="number">51</span>) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">syscall</span>(<span class="number">1</span>, <span class="number">1</span>, <span class="string">&quot;no\n&quot;</span>, <span class="number">3</span>);</span><br><span class="line">    <span class="built_in">sub_1267</span>(qword_7958);</span><br><span class="line">    <span class="built_in">syscall</span>(<span class="number">60</span>, <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( (dword_7930 ^ byte_7900[dword_7934 - <span class="number">1</span>]) != byte_2020[dword_7934 - <span class="number">1</span>] )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">syscall</span>(<span class="number">1</span>, <span class="number">1</span>, <span class="string">&quot;no\n&quot;</span>, <span class="number">3</span>);</span><br><span class="line">    <span class="built_in">sub_1267</span>(qword_7958);</span><br><span class="line">    <span class="built_in">syscall</span>(<span class="number">60</span>, <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( dword_7934 == <span class="number">46</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">syscall</span>(<span class="number">1</span>, <span class="number">1</span>, <span class="string">&quot;ok\n&quot;</span>, <span class="number">3</span>);</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">45</span>; ++i )</span><br><span class="line">      v6[i] = <span class="number">-86</span>;</span><br><span class="line">    <span class="built_in">sub_13C4</span>(qword_7958, <span class="number">322376503</span>, v6, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">syscall</span>(<span class="number">60</span>, <span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  v5 = <span class="built_in">sub_1189</span>(&amp;dword_7930);</span><br><span class="line">  <span class="built_in">sub_16F6</span>(v5, byte_7900, (dword_7934 + <span class="number">1</span>), qword_7958);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>This is the code of the main function after I patched the file.</li>
<li>Analyzing before executing the main code, it will execute the <code>handler()</code> function first.</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">handler</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v0; <span class="comment">// [rsp+10h] [rbp-80h] BYREF</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+14h] [rbp-7Ch]</span></span><br><span class="line">  __int64 v2; <span class="comment">// [rsp+18h] [rbp-78h]</span></span><br><span class="line">  _BYTE v3[<span class="number">48</span>]; <span class="comment">// [rsp+20h] [rbp-70h] BYREF</span></span><br><span class="line">  _QWORD v4[<span class="number">5</span>]; <span class="comment">// [rsp+50h] [rbp-40h] BYREF</span></span><br><span class="line">  __int64 v5; <span class="comment">// [rsp+78h] [rbp-18h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v6; <span class="comment">// [rsp+88h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v6 = __readfsqword(<span class="number">0x28u</span>);</span><br><span class="line">  <span class="built_in">memset</span>(v4, <span class="number">0</span>, <span class="built_in">sizeof</span>(v4));</span><br><span class="line">  v5 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">syscall</span>(<span class="number">1</span>, <span class="number">1</span>, <span class="string">&quot;&gt; &quot;</span>, <span class="number">2</span>);</span><br><span class="line">  v2 = <span class="built_in">syscall</span>(<span class="number">0</span>, <span class="number">0</span>, v4, <span class="number">47</span>);</span><br><span class="line">  <span class="keyword">if</span> ( v2 &lt;= <span class="number">45</span> || <span class="built_in">BYTE6</span>(v5) != <span class="number">10</span> &amp;&amp; <span class="built_in">BYTE6</span>(v5) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">syscall</span>(<span class="number">1</span>, <span class="number">1</span>, <span class="string">&quot;no\n&quot;</span>, <span class="number">3</span>);</span><br><span class="line">    <span class="built_in">sub_1267</span>(qword_7958);</span><br><span class="line">    <span class="built_in">syscall</span>(<span class="number">60</span>, <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">45</span>; ++i )</span><br><span class="line">    v3[i] = *(v4 + i);</span><br><span class="line">  v0 = dword_7930;</span><br><span class="line">  <span class="built_in">sub_11C2</span>(v3, <span class="number">46</span>, &amp;v0);</span><br><span class="line">  <span class="built_in">sub_16F6</span>(v0, v3, <span class="number">1</span>, qword_7958);</span><br><span class="line">  <span class="built_in">syscall</span>(<span class="number">60</span>, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>Here it is checking if the input has 46 characters or not. If so, it will copy all 46 characters into <code>sub_11C2()</code> to scramble the input with <code>seed = 0x13371337</code></li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">sub_11C2</span><span class="params">(__int64 a1, __int64 a2, __int64 a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v5; <span class="comment">// [rsp+27h] [rbp-11h]</span></span><br><span class="line">  __int64 i; <span class="comment">// [rsp+28h] [rbp-10h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v7; <span class="comment">// [rsp+30h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  result = a2 - <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = a2 - <span class="number">1</span>; i; --i )</span><br><span class="line">  &#123;</span><br><span class="line">    v7 = <span class="built_in">sub_1189</span>(a3) % (i + <span class="number">1</span>);</span><br><span class="line">    v5 = *(a1 + i);</span><br><span class="line">    *(a1 + i) = *(a1 + v7);</span><br><span class="line">    result = v5;</span><br><span class="line">    *(v7 + a1) = v5;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>Next, it will take this string after shuffling and put it into <code>sub_16F6()</code> as parameters for the next execution.</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">unsigned</span> __int64 __fastcall <span class="title">sub_13C4</span><span class="params">(__int64 a1, <span class="type">int</span> a2, __int64 a3, <span class="type">int</span> a4)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+20h] [rbp-B0h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v8; <span class="comment">// [rsp+24h] [rbp-ACh]</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// [rsp+24h] [rbp-ACh]</span></span><br><span class="line">  __int64 v10; <span class="comment">// [rsp+28h] [rbp-A8h]</span></span><br><span class="line">  _BYTE v11[<span class="number">48</span>]; <span class="comment">// [rsp+30h] [rbp-A0h] BYREF</span></span><br><span class="line">  __int64 v12; <span class="comment">// [rsp+60h] [rbp-70h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v13; <span class="comment">// [rsp+C8h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v13 = __readfsqword(<span class="number">0x28u</span>);</span><br><span class="line">  v8 = <span class="built_in">syscall</span>(<span class="number">257</span>, <span class="number">4294967196LL</span>, <span class="string">&quot;/proc/self/exe&quot;</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( (v8 &amp; <span class="number">0x80000000</span>) != <span class="number">0</span> )</span><br><span class="line">    <span class="built_in">syscall</span>(<span class="number">60</span>, <span class="number">1</span>);</span><br><span class="line">  <span class="built_in">syscall</span>(<span class="number">5</span>, v8, v11);</span><br><span class="line">  v10 = <span class="built_in">syscall</span>(<span class="number">9</span>, <span class="number">0</span>, v12, <span class="number">3</span>, <span class="number">34</span>, <span class="number">0xFFFFFFFFLL</span>, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( v10 &lt; <span class="number">0</span> )</span><br><span class="line">    <span class="built_in">syscall</span>(<span class="number">60</span>, <span class="number">1</span>);</span><br><span class="line">  <span class="built_in">syscall</span>(<span class="number">0</span>, v8, v10, v12);</span><br><span class="line">  <span class="built_in">syscall</span>(<span class="number">3</span>, v8);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">45</span>; ++i )</span><br><span class="line">    *(off_7938 + i + v10) = *(i + a3);</span><br><span class="line">  *(off_7940 + v10) = a2;</span><br><span class="line">  *(off_7948 + v10) = a4;</span><br><span class="line">  <span class="built_in">syscall</span>(<span class="number">87</span>, a1);</span><br><span class="line">  v9 = <span class="built_in">syscall</span>(<span class="number">257</span>, <span class="number">4294967196LL</span>, a1, <span class="number">577</span>, <span class="number">448</span>);</span><br><span class="line">  <span class="keyword">if</span> ( v9 &lt; <span class="number">0</span> )</span><br><span class="line">    <span class="built_in">syscall</span>(<span class="number">60</span>, <span class="number">1</span>);</span><br><span class="line">  <span class="built_in">syscall</span>(<span class="number">1</span>, v9, v10, v12);</span><br><span class="line">  <span class="built_in">syscall</span>(<span class="number">3</span>, v9);</span><br><span class="line">  <span class="built_in">syscall</span>(<span class="number">11</span>, v10, v12);</span><br><span class="line">  <span class="keyword">return</span> v13 - __readfsqword(<span class="number">0x28u</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">unsigned</span> __int64 __fastcall <span class="title">sub_165E</span><span class="params">(__int64 a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v2; <span class="comment">// [rsp+18h] [rbp-28h] BYREF</span></span><br><span class="line">  _QWORD v3[<span class="number">3</span>]; <span class="comment">// [rsp+20h] [rbp-20h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v4; <span class="comment">// [rsp+38h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v4 = __readfsqword(<span class="number">0x28u</span>);</span><br><span class="line">  v3[<span class="number">0</span>] = a1;</span><br><span class="line">  v3[<span class="number">1</span>] = <span class="string">&quot;l33t&quot;</span>;</span><br><span class="line">  v3[<span class="number">2</span>] = <span class="number">0</span>;</span><br><span class="line">  v2 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">syscall</span>(<span class="number">59</span>, a1, v3, &amp;v2);</span><br><span class="line">  <span class="built_in">syscall</span>(<span class="number">60</span>, <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">return</span> v4 - __readfsqword(<span class="number">0x28u</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>This function is actually used to check the argument <code>l33t</code> for the next syscall of the executable file, so there’s no need to pay attention.</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( dword_7934 &amp;&amp; (a1 &lt;= <span class="number">1</span> || *a2[<span class="number">1</span>] != <span class="string">&#x27;l&#x27;</span> || a2[<span class="number">1</span>][<span class="number">1</span>] != <span class="string">&#x27;3&#x27;</span>) )</span><br><span class="line"> &#123;</span><br><span class="line">   <span class="built_in">syscall</span>(<span class="number">1</span>, <span class="number">1</span>, <span class="string">&quot;no\n&quot;</span>, <span class="number">3</span>);</span><br><span class="line">   <span class="built_in">sub_1267</span>(qword_7958);</span><br><span class="line">   <span class="built_in">syscall</span>(<span class="number">60</span>, <span class="number">1</span>);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>It checks here, if satisfied, it jumps to the main flag check section.</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">if</span> ( (dword_7930 ^ byte_7900[dword_7934 - <span class="number">1</span>]) != byte_2020[dword_7934 - <span class="number">1</span>] )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">syscall</span>(<span class="number">1</span>, <span class="number">1</span>, <span class="string">&quot;no\n&quot;</span>, <span class="number">3</span>);</span><br><span class="line">    <span class="built_in">sub_1267</span>(qword_7958);</span><br><span class="line">    <span class="built_in">syscall</span>(<span class="number">60</span>, <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( dword_7934 == <span class="number">46</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">syscall</span>(<span class="number">1</span>, <span class="number">1</span>, <span class="string">&quot;ok\n&quot;</span>, <span class="number">3</span>);</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">45</span>; ++i )</span><br><span class="line">      v6[i] = <span class="number">-86</span>;</span><br><span class="line">    <span class="built_in">sub_13C4</span>(qword_7958, <span class="number">322376503</span>, v6, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">syscall</span>(<span class="number">60</span>, <span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  v5 = <span class="built_in">sub_1189</span>(&amp;dword_7930);</span><br><span class="line">  <span class="built_in">sub_16F6</span>(v5, byte_7900, dword_7934 + <span class="number">1</span>, qword_7958);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>Here I understand that the program follows the flow of input flag len 46 -&gt; Shuffle the flag -&gt; Xor each character with the key generated at <code>v5 = sub_1189(&amp;dword_7930);</code>. If after xor all match <code>byte_2020</code> then pass.</li>
<li>Initially <code>seed = 0x13371337</code> here:</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">sub_11C2</span><span class="params">(__int64 a1, __int64 a2, __int64 a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v5; <span class="comment">// [rsp+27h] [rbp-11h]</span></span><br><span class="line">  __int64 i; <span class="comment">// [rsp+28h] [rbp-10h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v7; <span class="comment">// [rsp+30h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  result = a2 - <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = a2 - <span class="number">1</span>; i; --i )</span><br><span class="line">  &#123;</span><br><span class="line">    v7 = <span class="built_in">sub_1189</span>(a3) % (i + <span class="number">1</span>);</span><br><span class="line">    v5 = *(a1 + i);</span><br><span class="line">    *(a1 + i) = *(a1 + v7);</span><br><span class="line">    result = v5;</span><br><span class="line">    *(v7 + a1) = v5;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">sub_1189</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  *a1 = <span class="number">1664525</span> * *a1 + <span class="number">1013904223</span>;</span><br><span class="line">  <span class="keyword">return</span> *a1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>It has generated the first key with seed 45 times. The next times, that is, the key from the 2nd character onwards, is only generated once. From there, I built the key generation script.</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">sub_1189</span>(<span class="params">a1</span>):</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">1664525</span> * a1 + <span class="number">1013904223</span>) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line"></span><br><span class="line">a1 = <span class="number">0x13371337</span></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">45</span>):</span><br><span class="line">    a1 = sub_1189(a1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Key đầu:&quot;</span>, <span class="built_in">hex</span>(a1 &amp; <span class="number">0xFF</span>))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;45 key tiếp theo:&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">45</span>):</span><br><span class="line">    a1 = sub_1189(a1)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">hex</span>(a1 &amp; <span class="number">0xFF</span>), end=<span class="string">&quot;, &quot;</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Key đầu: 0x6</span><br><span class="line">45 key tiếp theo:</span><br><span class="line">0xad, 0x28, 0x67, 0x9a, 0x31, 0xdc, 0x8b, 0x6e, 0xf5, 0xd0, 0xef, 0x82, 0xf9, 0x4, 0x93, 0xd6, 0x3d, 0x78, 0x77, 0x6a, 0xc1, 0x2c, 0x9b, 0x3e, 0x85, 0x20, 0xff, 0x52, 0x89, 0x54, 0xa3, 0xa6, 0xcd, 0xc8, 0x87, 0x3a, 0x51, 0x7c, 0xab, 0xe, 0x15, 0x70, 0xf, 0x22, 0x19</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">enc = [<span class="number">0x72</span>, <span class="number">0xC3</span>, <span class="number">0x6B</span>, <span class="number">0x0C</span>, <span class="number">0xCF</span>, <span class="number">0x65</span>, <span class="number">0xED</span>, <span class="number">0xBA</span>, <span class="number">0x18</span>, <span class="number">0xCA</span>,</span><br><span class="line">  <span class="number">0x8F</span>, <span class="number">0x99</span>, <span class="number">0xE6</span>, <span class="number">0x8A</span>, <span class="number">0x7F</span>, <span class="number">0xA6</span>, <span class="number">0xE4</span>, <span class="number">0x44</span>, <span class="number">0x4C</span>, <span class="number">0x14</span>,</span><br><span class="line">  <span class="number">0x5B</span>, <span class="number">0x9E</span>, <span class="number">0x73</span>, <span class="number">0xD3</span>, <span class="number">0x61</span>, <span class="number">0xEB</span>, <span class="number">0x44</span>, <span class="number">0x82</span>, <span class="number">0x0D</span>, <span class="number">0xC4</span>,</span><br><span class="line">  <span class="number">0x07</span>, <span class="number">0xC7</span>, <span class="number">0xE5</span>, <span class="number">0x82</span>, <span class="number">0xE5</span>, <span class="number">0xB7</span>, <span class="number">0x0A</span>, <span class="number">0x39</span>, <span class="number">0x4C</span>, <span class="number">0xD2</span>,</span><br><span class="line">  <span class="number">0x51</span>, <span class="number">0x53</span>, <span class="number">0x05</span>, <span class="number">0x50</span>, <span class="number">0x12</span>, <span class="number">0x6C</span>]</span><br><span class="line"></span><br><span class="line">key = [<span class="number">0x06</span>, <span class="number">0xad</span>, <span class="number">0x28</span>, <span class="number">0x67</span>, <span class="number">0x9a</span>, <span class="number">0x31</span>, <span class="number">0xdc</span>, <span class="number">0x8b</span>, <span class="number">0x6e</span>, <span class="number">0xf5</span>, <span class="number">0xd0</span>, <span class="number">0xef</span>, <span class="number">0x82</span>, <span class="number">0xf9</span>, <span class="number">0x4</span>, <span class="number">0x93</span>, <span class="number">0xd6</span>, <span class="number">0x3d</span>, <span class="number">0x78</span>, <span class="number">0x77</span>, <span class="number">0x6a</span>, <span class="number">0xc1</span>, <span class="number">0x2c</span>, <span class="number">0x9b</span>, <span class="number">0x3e</span>, <span class="number">0x85</span>, <span class="number">0x20</span>, <span class="number">0xff</span>, <span class="number">0x52</span>, <span class="number">0x89</span>, <span class="number">0x54</span>, <span class="number">0xa3</span>, <span class="number">0xa6</span>, <span class="number">0xcd</span>, <span class="number">0xc8</span>, <span class="number">0x87</span>, <span class="number">0x3a</span>, <span class="number">0x51</span>, <span class="number">0x7c</span>, <span class="number">0xab</span>, <span class="number">0xe</span>, <span class="number">0x15</span>, <span class="number">0x70</span>, <span class="number">0xf</span>, <span class="number">0x22</span>, <span class="number">0x19</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc)):</span><br><span class="line">    flag = enc[i] ^ key[i]</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(flag), end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>Now we just need to restore the original form after shuffling using the Fisher–Yates algorithm.</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">sub_1189</span>(<span class="params">a1</span>):</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">1664525</span> * a1 + <span class="number">1013904223</span>) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fisher_yates_indices</span>(<span class="params">length, seed</span>):</span><br><span class="line">    swaps = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">reversed</span>(<span class="built_in">range</span>(<span class="number">1</span>, length)):</span><br><span class="line">        seed = sub_1189(seed)</span><br><span class="line">        j = seed % (i + <span class="number">1</span>)</span><br><span class="line">        swaps.append((i, j))</span><br><span class="line">    <span class="keyword">return</span> swaps, seed</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">reverse_shuffle</span>(<span class="params">shuffled, seed</span>):</span><br><span class="line">    arr = <span class="built_in">list</span>(shuffled)</span><br><span class="line">    swaps, _ = fisher_yates_indices(<span class="built_in">len</span>(arr), seed)</span><br><span class="line">    <span class="keyword">for</span> i, j <span class="keyword">in</span> <span class="built_in">reversed</span>(swaps):</span><br><span class="line">        arr[i], arr[j] = arr[j], arr[i]</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(arr)</span><br><span class="line"></span><br><span class="line">shuffled = <span class="string">&quot;tnCkUT11v?_vds&#123;52y4c1__H_nd&#125;_MSdCO-00h0y_Fu_0u&quot;</span></span><br><span class="line"></span><br><span class="line">seed = <span class="number">0x13371337</span></span><br><span class="line"></span><br><span class="line">flag = reverse_shuffle(shuffled, seed)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Flag:&quot;</span>, flag)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>FLAG: <code>HCMUS-CTF&#123;d1d_y0u_kn0vv_y0u12_O5_c4n_d0_th1s?&#125;</code></p>

        
      </div>

         
    </div>
    
     
  </div>
  
    
<nav id="article-nav">
  <a class="article-nav-btn left "
    
      href="/2025/08/19/Indefinite/"
      title="Reverse/Indefinite"
     >
    <i class="fa-solid fa-angle-left"></i>
    <p class="title-text">
      
        Reverse/Indefinite
        
    </p>
  </a>
  <a class="article-nav-btn right "
    
      href="/2025/08/19/E-commerce/"
      title="[Malware Analysis] E-commerce"
     >

    <p class="title-text">
      
        [Malware Analysis] E-commerce
        
    </p>
    <i class="fa-solid fa-angle-right"></i>
  </a>
</nav>


  
</article>





    </div>
    <div id="footer-wrapper">
      <footer id="footer">
  
  <div id="footer-info" class="inner">
    
    &copy; 2025 nukoneZ<br>
    Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> & Theme <a target="_blank" rel="noopener" href="https://github.com/saicaca/hexo-theme-vivia">Vivia</a>
  </div>
</footer>

    </div>
    <div class="back-to-top-wrapper">
    <button id="back-to-top-btn" class="back-to-top-btn hide" onclick="topFunction()">
        <i class="fa-solid fa-angle-up"></i>
    </button>
</div>

<script>
    function topFunction() {
        window.scroll({ top: 0, behavior: 'smooth' });
    }
    let btn = document.getElementById('back-to-top-btn');
    function scrollFunction() {
        if (document.body.scrollTop > 600 || document.documentElement.scrollTop > 600) {
            btn.classList.remove('hide')
        } else {
            btn.classList.add('hide')
        }
    }
    window.onscroll = function() {
        scrollFunction();
    }
</script>

  </div>
  <script src="/js/light-dark-switch.js"></script>
</body>
</html>
