<!DOCTYPE html>


<html theme="dark" showBanner="true" hasBanner="true" > 
<link href="https://cdn.staticfile.org/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet">
<link href="https://cdn.staticfile.org/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet">
<link href="https://cdn.staticfile.org/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet">
<script src="/js/color.global.min.js" ></script>
<script src="/js/load-settings.js" ></script>
<head>
  <meta charset="utf-8">
  
  
  

  
  <title>Reverse/Alien Saboteur | nukoneZ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="preload" href="/css/fonts/Roboto-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous">
  <link rel="preload" href="/css/fonts/Roboto-Bold.ttf" as="font" type="font/ttf" crossorigin="anonymous">

  <meta name="description" content="🏆 HackTheBox - Reverse ChallengeChallenge Description You finally manage to make it into the main computer of the vessel, it’s time to get this over with. You try to shutdown the vessel, however a co">
<meta property="og:type" content="article">
<meta property="og:title" content="Reverse&#x2F;Alien Saboteur">
<meta property="og:url" content="https://kykhongbithac.github.io/2025/08/18/Alien-Saboteur/">
<meta property="og:site_name" content="nukoneZ">
<meta property="og:description" content="🏆 HackTheBox - Reverse ChallengeChallenge Description You finally manage to make it into the main computer of the vessel, it’s time to get this over with. You try to shutdown the vessel, however a co">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://hackmd.io/_uploads/rkbEhVidge.png">
<meta property="og:image" content="https://hackmd.io/_uploads/BJfh1Sjdgx.png">
<meta property="og:image" content="https://hackmd.io/_uploads/HJR1gHiOee.png">
<meta property="og:image" content="https://hackmd.io/_uploads/Bk3qZrouel.png">
<meta property="og:image" content="https://hackmd.io/_uploads/BkPzXHjule.png">
<meta property="article:published_time" content="2025-08-18T05:00:00.000Z">
<meta property="article:modified_time" content="2025-08-19T14:18:06.000Z">
<meta property="article:author" content="Huỳnh Quốc Kỳ">
<meta property="article:tag" content="HackTheBox">
<meta property="article:tag" content="Reverse">
<meta property="article:tag" content="VM">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://hackmd.io/_uploads/rkbEhVidge.png">
  
    <link rel="alternate" href="/atom.xml" title="nukoneZ" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/image/favicon.png">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 7.3.0"></head>

<body>
  
  
    
<div id="banner" class="">
  <img src="/image/background.gif" itemprop="image">
  <div id="banner-dim"></div>
</div>
 
   
  <div id="main-grid" class="  ">
    <div id="nav" class=""  >
      <navbar id="navbar">
  <nav id="title-nav">
    <a href="/">
      <div id="vivia-logo">
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
      </div>
      <div>nukoneZ </div>
    </a>
  </nav>
  <nav id="main-nav">
    
      <a class="main-nav-link" href="/">Home</a>
    
      <a class="main-nav-link" href="/archives">Archives</a>
    
      <a class="main-nav-link" href="/about">About</a>
    
  </nav>
  <nav id="sub-nav">
    <a id="theme-btn" class="nav-icon">
      <span class="light-mode-icon"><svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M438.5-829.913v-48q0-17.452 11.963-29.476 11.964-12.024 29.326-12.024 17.363 0 29.537 12.024t12.174 29.476v48q0 17.452-11.963 29.476-11.964 12.024-29.326 12.024-17.363 0-29.537-12.024T438.5-829.913Zm0 747.826v-48q0-17.452 11.963-29.476 11.964-12.024 29.326-12.024 17.363 0 29.537 12.024t12.174 29.476v48q0 17.452-11.963 29.476-11.964 12.024-29.326 12.024-17.363 0-29.537-12.024T438.5-82.087ZM877.913-438.5h-48q-17.452 0-29.476-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537t29.476-12.174h48q17.452 0 29.476 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T877.913-438.5Zm-747.826 0h-48q-17.452 0-29.476-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537T82.087-521.5h48q17.452 0 29.476 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T130.087-438.5Zm660.174-290.87-34.239 32q-12.913 12.674-29.565 12.174-16.653-.5-29.327-13.174-12.674-12.673-12.554-28.826.12-16.152 12.794-28.826l33-35q12.913-12.674 30.454-12.674t30.163 12.847q12.709 12.846 12.328 30.826-.38 17.98-13.054 30.653ZM262.63-203.978l-32 34q-12.913 12.674-30.454 12.674t-30.163-12.847q-12.709-12.846-12.328-30.826.38-17.98 13.054-30.653l33.239-31q12.913-12.674 29.565-12.174 16.653.5 29.327 13.174 12.674 12.673 12.554 28.826-.12 16.152-12.794 28.826Zm466.74 33.239-32-33.239q-12.674-12.913-12.174-29.565.5-16.653 13.174-29.327 12.673-12.674 28.826-13.054 16.152-.38 28.826 12.294l35 33q12.674 12.913 12.674 30.454t-12.847 30.163q-12.846 12.709-30.826 12.328-17.98-.38-30.653-13.054ZM203.978-697.37l-34-33q-12.674-12.913-13.174-29.945-.5-17.033 12.174-29.707t31.326-13.293q18.653-.62 31.326 13.054l32 34.239q11.674 12.913 11.174 29.565-.5 16.653-13.174 29.327-12.673 12.674-28.826 12.554-16.152-.12-28.826-12.794ZM480-240q-100 0-170-70t-70-170q0-100 70-170t170-70q100 0 170 70t70 170q0 100-70 170t-170 70Zm-.247-82q65.703 0 111.475-46.272Q637-414.544 637-480.247t-45.525-111.228Q545.95-637 480.247-637t-111.475 45.525Q323-545.95 323-480.247t45.525 111.975Q414.05-322 479.753-322ZM481-481Z"/></svg></span>
      <span class="dark-mode-icon"><svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M480.239-116.413q-152.63 0-258.228-105.478Q116.413-327.37 116.413-480q0-130.935 77.739-227.435t206.304-125.043q43.022-9.631 63.87 10.869t3.478 62.805q-8.891 22.043-14.315 44.463-5.424 22.42-5.424 46.689 0 91.694 64.326 155.879 64.325 64.186 156.218 64.186 24.369 0 46.978-4.946 22.609-4.945 44.413-14.076 42.826-17.369 62.967 1.142 20.142 18.511 10.511 61.054Q807.174-280 712.63-198.206q-94.543 81.793-232.391 81.793Zm0-95q79.783 0 143.337-40.217 63.554-40.218 95.793-108.283-15.608 4.044-31.097 5.326-15.49 1.283-31.859.805-123.706-4.066-210.777-90.539-87.071-86.473-91.614-212.092-.24-16.369.923-31.978 1.164-15.609 5.446-30.978-67.826 32.478-108.282 96.152Q211.652-559.543 211.652-480q0 111.929 78.329 190.258 78.329 78.329 190.258 78.329ZM466.13-465.891Z"/></svg></span>
    </a>
    
      <a id="nav-rss-link" class="nav-icon mobile-hide" href="/atom.xml" title="RSS Feed">
        <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M198-120q-25.846 0-44.23-18.384-18.384-18.385-18.384-44.23 0-25.846 18.384-44.23 18.384-18.385 44.23-18.385 25.846 0 44.23 18.385 18.384 18.384 18.384 44.23 0 25.845-18.384 44.23Q223.846-120 198-120Zm538.385 0q-18.846 0-32.923-13.769-14.076-13.769-15.922-33.23-8.692-100.616-51.077-188.654-42.385-88.039-109.885-155.539-67.5-67.501-155.539-109.885Q283-663.462 182.385-672.154q-19.461-1.846-33.23-16.23-13.769-14.385-13.769-33.846t14.076-32.922q14.077-13.461 32.923-12.23 120.076 8.692 226.038 58.768 105.961 50.077 185.73 129.846 79.769 79.769 129.846 185.731 50.077 105.961 58.769 226.038 1.231 18.846-12.538 32.922Q756.461-120 736.385-120Zm-252 0q-18.231 0-32.423-13.461t-18.653-33.538Q418.155-264.23 348.886-333.5q-69.27-69.27-166.501-84.423-20.077-4.462-33.538-18.961-13.461-14.5-13.461-33.346 0-19.076 13.884-33.23 13.884-14.153 33.115-10.922 136.769 15.384 234.384 112.999 97.615 97.615 112.999 234.384 3.231 19.23-10.538 33.115Q505.461-120 484.385-120Z"/></svg>
      </a>
    
    <div id="nav-menu-btn" class="nav-icon">
      <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M177.37-252.282q-17.453 0-29.477-11.964-12.024-11.963-12.024-29.326t12.024-29.537q12.024-12.174 29.477-12.174h605.26q17.453 0 29.477 11.964 12.024 11.963 12.024 29.326t-12.024 29.537q-12.024 12.174-29.477 12.174H177.37Zm0-186.218q-17.453 0-29.477-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537T177.37-521.5h605.26q17.453 0 29.477 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T782.63-438.5H177.37Zm0-186.217q-17.453 0-29.477-11.964-12.024-11.963-12.024-29.326t12.024-29.537q12.024-12.174 29.477-12.174h605.26q17.453 0 29.477 11.964 12.024 11.963 12.024 29.326t-12.024 29.537q-12.024 12.174-29.477 12.174H177.37Z"/></svg>
    </div>
  </nav>
</navbar>
<div id="nav-dropdown" class="hidden">
  <div id="dropdown-link-list">
    
      <a class="nav-dropdown-link" href="/">Home</a>
    
      <a class="nav-dropdown-link" href="/archives">Archives</a>
    
      <a class="nav-dropdown-link" href="/about">About</a>
    
    
      <a class="nav-dropdown-link" href="/atom.xml" title="RSS Feed">RSS</a>
     
    </div>
</div>
<script>
  let dropdownBtn = document.getElementById("nav-menu-btn");
  let dropdownEle = document.getElementById("nav-dropdown");
  dropdownBtn.onclick = function() {
    dropdownEle.classList.toggle("hidden");
  }
</script>
    </div>
    <div id="sidebar-wrapper">
      <sidebar id="sidebar">
  
    <div class="widget-wrap">
  <div class="info-card">
    <div class="avatar">
      
        <image src=/image/avata.gif></image>
      
      <div class="img-dim"></div>
    </div>
    <div class="info">
      <div class="username">nukoneZ </div>
      <div class="dot"></div>
      <div class="subtitle">Blog | CTF | Security </div>
      <div class="link-list">
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://www.facebook.com/quocky05" title="Facebook"><i class="fa-brands fa-facebook"></i></a>
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://www.instagram.com/nukonez" title="Instagram"><i class="fa-brands fa-instagram"></i></a>
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://github.com/kykhongbithac" title="GitHub"><i class="fa-brands fa-github"></i></a>
        
          <a class="link-btn" href="mailto:huynhky3010@gmail.com" title="Gmail"><i class="fa-solid fa-envelope"></i></a>
         
      </div>  
    </div>
  </div>
</div>

  
  <div class="sticky">
    
      


  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">Categories</h3>
      <div class="category-box">
            <a class="category-link" href="/categories/Malware-Analysis/">
                Malware Analysis
                <div class="category-count">1</div>
            </a>
        
            <a class="category-link" href="/categories/Write-up/">
                Write-up
                <div class="category-count">6</div>
            </a>
        
            <a class="category-link" href="/categories/Blog/">
                Blog
                <div class="category-count">1</div>
            </a>
        </div>
    </div>
  </div>


    
      
  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">Tags</h3>
      <ul class="widget-tag-list" itemprop="keywords"><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Analysis/" rel="tag">Analysis</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/CTF/" rel="tag">CTF</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/FPTU/" rel="tag">FPTU</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/HCMUS-CTF-2025/" rel="tag">HCMUS-CTF-2025</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/HOLACTF2025/" rel="tag">HOLACTF2025</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/HackTheBox/" rel="tag">HackTheBox</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/HacktheonSejong/" rel="tag">HacktheonSejong</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Korea-%F0%9F%87%B0%F0%9F%87%B7/" rel="tag">Korea 🇰🇷</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Malware/" rel="tag">Malware</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/PTITHCM-CTF-2025/" rel="tag">PTITHCM CTF 2025</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Reverse/" rel="tag">Reverse</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Reverse-Engineering/" rel="tag">Reverse Engineering</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ScriptCTF2025/" rel="tag">ScriptCTF2025</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Security/" rel="tag">Security</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Trips/" rel="tag">Trips</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/VM/" rel="tag">VM</a></li></ul>
    </div>
  </div>


    
      
  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">Archives</h3>
      
      
        <a class="archive-link" href="/archives/2025/09 ">
          September 2025 
          <div class="archive-count">2 </div>
        </a>
      
        <a class="archive-link" href="/archives/2025/08 ">
          August 2025 
          <div class="archive-count">6 </div>
        </a>
      
    </div>
  </div>


    
      
  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">Recent Posts</h3>
      <ul>
        
          <a class="recent-link" href="/2025/09/17/fob%20PTITHCM%20CTF%202025/" title="Reverse/fob (PTITHCM 2025)" >
            <div class="recent-link-text">
              Reverse/fob (PTITHCM 2025)
            </div>
          </a>
        
          <a class="recent-link" href="/2025/09/01/HOLACTF%202025%20Writeups/" title="HOLACTF 2025 Writeups" >
            <div class="recent-link-text">
              HOLACTF 2025 Writeups
            </div>
          </a>
        
          <a class="recent-link" href="/2025/08/19/Korea-2025/" title="Hacktheon Sejong 2025 🇰🇷" >
            <div class="recent-link-text">
              Hacktheon Sejong 2025 🇰🇷
            </div>
          </a>
        
          <a class="recent-link" href="/2025/08/19/Indefinite/" title="Reverse/Indefinite" >
            <div class="recent-link-text">
              Reverse/Indefinite
            </div>
          </a>
        
          <a class="recent-link" href="/2025/08/19/hcmusctf2025/" title="Reverse/HCMUS-CTF 2025" >
            <div class="recent-link-text">
              Reverse/HCMUS-CTF 2025
            </div>
          </a>
        
      </ul>
    </div>
  </div>

    
  </div>
</sidebar>
    </div>
    <div id="content-body">
       


<article id="post-Alien-Saboteur" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
    
   
  <div class="article-inner">
    <div class="article-main">
      <header class="article-header">
        
<div class="main-title-bar">
  <div class="main-title-dot"></div>
  
    
      <h1 class="p-name article-title" itemprop="headline name">
        Reverse/Alien Saboteur
      </h1>
    
  
</div>

        <div class='meta-info-bar'>
          <div class="meta-info">
  <time class="dt-published" datetime="2025-08-18T05:00:00.000Z" itemprop="datePublished">2025-08-18</time>
</div>
          <div class="need-seperator meta-info">
            <div class="meta-cate-flex">
  
  <a class="meta-cate-link" href="/categories/Write-up/">Write-up</a>
   
</div>
  
          </div>
          <div class="wordcount need-seperator meta-info">
            30k words 
          </div>
        </div>
        
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/HackTheBox/" rel="tag">HackTheBox</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Reverse/" rel="tag">Reverse</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/VM/" rel="tag">VM</a></li></ul>

      </header>
      <div class="e-content article-entry" itemprop="articleBody">
        
          <h1 id="🏆-HackTheBox-Reverse-Challenge"><a href="#🏆-HackTheBox-Reverse-Challenge" class="headerlink" title="🏆 HackTheBox - Reverse Challenge"></a>🏆 HackTheBox - Reverse Challenge</h1><h2 id="Challenge-Description"><a href="#Challenge-Description" class="headerlink" title="Challenge Description"></a>Challenge Description</h2><blockquote>
<p>You finally manage to make it into the main computer of the vessel, it’s time to get this over with. You try to shutdown the vessel, however a couple of access codes unknown to you are needed. You try to figure them out, but the computer start speaking some weird language, it seems like gibberish…</p>
</blockquote>
<hr>
<h2 id="🔎-Analysis"><a href="#🔎-Analysis" class="headerlink" title="🔎 Analysis"></a>🔎 Analysis</h2><ul>
<li>This challenge gives me 2 files <code>vm</code> and <code>bin</code>. It is a VM emulator.</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  FILE *stream; <span class="comment">// [rsp+10h] [rbp-20h]</span></span><br><span class="line">  __int64 size; <span class="comment">// [rsp+18h] [rbp-18h]</span></span><br><span class="line">  <span class="type">void</span> *ptr; <span class="comment">// [rsp+20h] [rbp-10h]</span></span><br><span class="line">  __int64 v7; <span class="comment">// [rsp+28h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( argc &lt;= <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Usage: ./chall file&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  stream = fopen(argv[<span class="number">1</span>], <span class="string">&quot;rb&quot;</span>);</span><br><span class="line">  fseek(stream, <span class="number">0</span>, <span class="number">2</span>);</span><br><span class="line">  size = ftell(stream);</span><br><span class="line">  rewind(stream);</span><br><span class="line">  ptr = <span class="built_in">malloc</span>(size);</span><br><span class="line">  fread(ptr, size, <span class="number">1u</span>, stream);</span><br><span class="line">  fclose(stream);</span><br><span class="line">  v7 = vm_create(ptr, size);</span><br><span class="line">  vm_run(v7);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">vm_step</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> *a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> __int8 v2; <span class="comment">// [rsp+1Fh] [rbp-1h]</span></span><br><span class="line"></span><br><span class="line">  v2 = *(*(a1 + <span class="number">18</span>) + *a1);</span><br><span class="line">  <span class="keyword">if</span> ( v2 &gt; <span class="number">0x19u</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;dead&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> (original_ops[v2])(a1);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>The <code>return(original_ops[v2])(a1);</code> part will be a list-based function call with 24 opcodes.<br><img src="https://hackmd.io/_uploads/rkbEhVidge.png" alt="image"></li>
<li>It will execute according to the syntax <code>[opcode][operand 1][operand 2][padding ][padding ][padding ]</code></li>
<li>Based on that, I will rewrite the interpreter corresponding to the logic of the bin file using the python tool.</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">parse_vm_add</span>(<span class="params">bytecode, pc</span>):</span><br><span class="line">    dst_reg  = bytecode[pc + <span class="number">1</span>]</span><br><span class="line">    src1_reg = bytecode[pc + <span class="number">2</span>]</span><br><span class="line">    src2_reg = bytecode[pc + <span class="number">3</span>]</span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;[0x<span class="subst">&#123;pc:04X&#125;</span>] ADD   R<span class="subst">&#123;dst_reg&#125;</span> = R<span class="subst">&#123;src1_reg&#125;</span> + R<span class="subst">&#123;src2_reg&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_vm_addi</span>(<span class="params">bytecode, pc</span>):</span><br><span class="line">    dst_reg  = bytecode[pc + <span class="number">1</span>]</span><br><span class="line">    src1_reg = bytecode[pc + <span class="number">2</span>]</span><br><span class="line">    imm_val  = bytecode[pc + <span class="number">3</span>]</span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;[0x<span class="subst">&#123;pc:04X&#125;</span>] ADDI  R<span class="subst">&#123;dst_reg&#125;</span> = R<span class="subst">&#123;src1_reg&#125;</span> + <span class="subst">&#123;imm_val&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_vm_sub</span>(<span class="params">bytecode, pc</span>):</span><br><span class="line">    dst_reg  = bytecode[pc + <span class="number">1</span>]</span><br><span class="line">    src1_reg = bytecode[pc + <span class="number">2</span>]</span><br><span class="line">    src2_reg = bytecode[pc + <span class="number">3</span>]</span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;[0x<span class="subst">&#123;pc:04X&#125;</span>] SUB   R<span class="subst">&#123;dst_reg&#125;</span> = R<span class="subst">&#123;src1_reg&#125;</span> - R<span class="subst">&#123;src2_reg&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_vm_subi</span>(<span class="params">bytecode, pc</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Giải mã lệnh SUBI (opcode 0x03).&quot;&quot;&quot;</span></span><br><span class="line">    dst_reg  = bytecode[pc + <span class="number">1</span>]</span><br><span class="line">    src1_reg = bytecode[pc + <span class="number">2</span>]</span><br><span class="line">    imm_val  = bytecode[pc + <span class="number">3</span>]</span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;[0x<span class="subst">&#123;pc:04X&#125;</span>] SUBI  R<span class="subst">&#123;dst_reg&#125;</span> = R<span class="subst">&#123;src1_reg&#125;</span> - <span class="subst">&#123;imm_val&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_vm_mul</span>(<span class="params">bytecode, pc</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Giải mã lệnh MUL (opcode 0x04).&quot;&quot;&quot;</span></span><br><span class="line">    dst_reg  = bytecode[pc + <span class="number">1</span>]</span><br><span class="line">    src1_reg = bytecode[pc + <span class="number">2</span>]</span><br><span class="line">    src2_reg = bytecode[pc + <span class="number">3</span>]</span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;[0x<span class="subst">&#123;pc:04X&#125;</span>] MUL   R<span class="subst">&#123;dst_reg&#125;</span> = R<span class="subst">&#123;src1_reg&#125;</span> * R<span class="subst">&#123;src2_reg&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_vm_muli</span>(<span class="params">bytecode, pc</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Giải mã lệnh MULI (opcode 0x05).&quot;&quot;&quot;</span></span><br><span class="line">    dst_reg  = bytecode[pc + <span class="number">1</span>]</span><br><span class="line">    src1_reg = bytecode[pc + <span class="number">2</span>]</span><br><span class="line">    imm_val  = bytecode[pc + <span class="number">3</span>]</span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;[0x<span class="subst">&#123;pc:04X&#125;</span>] MULI  R<span class="subst">&#123;dst_reg&#125;</span> = R<span class="subst">&#123;src1_reg&#125;</span> * <span class="subst">&#123;imm_val&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_vm_div</span>(<span class="params">bytecode, pc</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Giải mã lệnh DIV (opcode 0x06).&quot;&quot;&quot;</span></span><br><span class="line">    dst_reg  = bytecode[pc + <span class="number">1</span>]</span><br><span class="line">    src1_reg = bytecode[pc + <span class="number">2</span>]</span><br><span class="line">    src2_reg = bytecode[pc + <span class="number">3</span>]</span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;[0x<span class="subst">&#123;pc:04X&#125;</span>] DIV   R<span class="subst">&#123;dst_reg&#125;</span> = R<span class="subst">&#123;src1_reg&#125;</span> / R<span class="subst">&#123;src2_reg&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_vm_cmp</span>(<span class="params">bytecode, pc</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Giải mã lệnh CMP (opcode 0x07).&quot;&quot;&quot;</span></span><br><span class="line">    src1_reg = bytecode[pc + <span class="number">2</span>]</span><br><span class="line">    src2_reg = bytecode[pc + <span class="number">3</span>]</span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;[0x<span class="subst">&#123;pc:04X&#125;</span>] CMP   R<span class="subst">&#123;src1_reg&#125;</span> == R<span class="subst">&#123;src2_reg&#125;</span> -&gt; FLAG&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_vm_jmp</span>(<span class="params">bytecode, pc</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Giải mã lệnh JMP (opcode 0x08).&quot;&quot;&quot;</span></span><br><span class="line">    reg = bytecode[pc + <span class="number">2</span>]</span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;[0x<span class="subst">&#123;pc:04X&#125;</span>] JMP   PC += R<span class="subst">&#123;reg&#125;</span> + 6&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_vm_inv</span>(<span class="params">bytecode, pc</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Giải mã lệnh INV (opcode 0x09) - syscall invocation.&quot;&quot;&quot;</span></span><br><span class="line">    sysno = bytecode[pc + <span class="number">1</span>]</span><br><span class="line">    argc  = bytecode[pc + <span class="number">2</span>]</span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;[0x<span class="subst">&#123;pc:04X&#125;</span>] INV   syscall(<span class="subst">&#123;sysno&#125;</span>, argc=<span class="subst">&#123;argc&#125;</span>)&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_vm_push</span>(<span class="params">bytecode, pc</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Giải mã lệnh PUSH (opcode 0x0A).&quot;&quot;&quot;</span></span><br><span class="line">    reg = bytecode[pc + <span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;[0x<span class="subst">&#123;pc:04X&#125;</span>] PUSH  R<span class="subst">&#123;reg&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_vm_pop</span>(<span class="params">bytecode, pc</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Giải mã lệnh POP (opcode 0x0B).&quot;&quot;&quot;</span></span><br><span class="line">    reg = bytecode[pc + <span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;[0x<span class="subst">&#123;pc:04X&#125;</span>] POP   R<span class="subst">&#123;reg&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_vm_mov</span>(<span class="params">bytecode, pc</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Giải mã lệnh MOV (opcode 0x0C).&quot;&quot;&quot;</span></span><br><span class="line">    reg = bytecode[pc + <span class="number">1</span>]</span><br><span class="line">    imm_val = <span class="built_in">int</span>.from_bytes(bytecode[pc + <span class="number">2</span>:pc + <span class="number">6</span>], byteorder=<span class="string">&#x27;little&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;[0x<span class="subst">&#123;pc:04X&#125;</span>] MOV   R<span class="subst">&#123;reg&#125;</span> = <span class="subst">&#123;imm_val&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_vm_nop</span>(<span class="params">bytecode, pc</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Giải mã lệnh NOP (opcode 0x0D).&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;[0x<span class="subst">&#123;pc:04X&#125;</span>] NOP&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_vm_exit</span>(<span class="params">bytecode, pc</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Giải mã lệnh EXIT (opcode 0x0E).&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;[0x<span class="subst">&#123;pc:04X&#125;</span>] EXIT&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_vm_print</span>(<span class="params">bytecode, pc</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Giải mã lệnh PRINT (opcode 0x0F).&quot;&quot;&quot;</span></span><br><span class="line">    reg = bytecode[pc + <span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;[0x<span class="subst">&#123;pc:04X&#125;</span>] PRINT R<span class="subst">&#123;reg&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_vm_putc</span>(<span class="params">bytecode, pc</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Giải mã lệnh PUTC (opcode 0x10).&quot;&quot;&quot;</span></span><br><span class="line">    imm_val = bytecode[pc + <span class="number">1</span>]</span><br><span class="line">    char_repr = <span class="built_in">chr</span>(imm_val) <span class="keyword">if</span> <span class="number">32</span> &lt;= imm_val &lt;= <span class="number">126</span> <span class="keyword">else</span> <span class="string">f&quot;\\x<span class="subst">&#123;imm_val:02x&#125;</span>&quot;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;[0x<span class="subst">&#123;pc:04X&#125;</span>] PUTC  &#x27;<span class="subst">&#123;char_repr&#125;</span>&#x27;  (0x<span class="subst">&#123;imm_val:02X&#125;</span>)&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_vm_je</span>(<span class="params">bytecode, pc</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Giải mã lệnh JE (opcode 0x11).&quot;&quot;&quot;</span></span><br><span class="line">    reg1 = bytecode[pc + <span class="number">1</span>]</span><br><span class="line">    reg2 = bytecode[pc + <span class="number">2</span>]</span><br><span class="line">    target = <span class="built_in">int</span>.from_bytes(bytecode[pc + <span class="number">3</span>:pc + <span class="number">5</span>], byteorder=<span class="string">&#x27;little&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;[0x<span class="subst">&#123;pc:04X&#125;</span>] JE    R<span class="subst">&#123;reg1&#125;</span> == R<span class="subst">&#123;reg2&#125;</span> -&gt; jump to <span class="subst">&#123;target * <span class="number">6</span>:#04x&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_vm_jne</span>(<span class="params">bytecode, pc</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Giải mã lệnh JNE (opcode 0x12).&quot;&quot;&quot;</span></span><br><span class="line">    reg1 = bytecode[pc + <span class="number">1</span>]</span><br><span class="line">    reg2 = bytecode[pc + <span class="number">2</span>]</span><br><span class="line">    target = <span class="built_in">int</span>.from_bytes(bytecode[pc + <span class="number">3</span>:pc + <span class="number">5</span>], byteorder=<span class="string">&#x27;little&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;[0x<span class="subst">&#123;pc:04X&#125;</span>] JNE   R<span class="subst">&#123;reg1&#125;</span> != R<span class="subst">&#123;reg2&#125;</span> -&gt; jump to <span class="subst">&#123;target * <span class="number">6</span>:#04x&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_vm_jle</span>(<span class="params">bytecode, pc</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Giải mã lệnh JLE (opcode 0x13).&quot;&quot;&quot;</span></span><br><span class="line">    reg1 = bytecode[pc + <span class="number">1</span>]</span><br><span class="line">    reg2 = bytecode[pc + <span class="number">2</span>]</span><br><span class="line">    target = <span class="built_in">int</span>.from_bytes(bytecode[pc + <span class="number">3</span>:pc + <span class="number">5</span>], byteorder=<span class="string">&#x27;little&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;[0x<span class="subst">&#123;pc:04X&#125;</span>] JLE   R<span class="subst">&#123;reg1&#125;</span> &lt;= R<span class="subst">&#123;reg2&#125;</span> -&gt; jump to <span class="subst">&#123;target * <span class="number">6</span>:#04x&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_vm_jge</span>(<span class="params">bytecode, pc</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Giải mã lệnh JGE (opcode 0x14).&quot;&quot;&quot;</span></span><br><span class="line">    reg1 = bytecode[pc + <span class="number">1</span>]</span><br><span class="line">    reg2 = bytecode[pc + <span class="number">2</span>]</span><br><span class="line">    target = <span class="built_in">int</span>.from_bytes(bytecode[pc + <span class="number">3</span>:pc + <span class="number">5</span>], byteorder=<span class="string">&#x27;little&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;[0x<span class="subst">&#123;pc:04X&#125;</span>] JGE   R<span class="subst">&#123;reg1&#125;</span> &gt;= R<span class="subst">&#123;reg2&#125;</span> -&gt; jump to <span class="subst">&#123;target * <span class="number">6</span>:#04x&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_vm_xor</span>(<span class="params">bytecode, pc</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Giải mã lệnh XOR (opcode 0x15).&quot;&quot;&quot;</span></span><br><span class="line">    dst_reg  = bytecode[pc + <span class="number">1</span>]</span><br><span class="line">    src1_reg = bytecode[pc + <span class="number">2</span>]</span><br><span class="line">    src2_reg = bytecode[pc + <span class="number">3</span>]</span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;[0x<span class="subst">&#123;pc:04X&#125;</span>] XOR   R<span class="subst">&#123;dst_reg&#125;</span> = R<span class="subst">&#123;src1_reg&#125;</span> ^ R<span class="subst">&#123;src2_reg&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_vm_store</span>(<span class="params">bytecode, pc</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Giải mã lệnh STORE (opcode 0x16).&quot;&quot;&quot;</span></span><br><span class="line">    addr_reg = bytecode[pc + <span class="number">1</span>]</span><br><span class="line">    value_reg = bytecode[pc + <span class="number">2</span>]</span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;[0x<span class="subst">&#123;pc:04X&#125;</span>] STORE [R<span class="subst">&#123;addr_reg&#125;</span>] = R<span class="subst">&#123;value_reg&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_vm_load</span>(<span class="params">bytecode, pc</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Giải mã lệnh LOAD (opcode 0x17).&quot;&quot;&quot;</span></span><br><span class="line">    dst_reg = bytecode[pc + <span class="number">1</span>]</span><br><span class="line">    addr_reg = bytecode[pc + <span class="number">2</span>]</span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;[0x<span class="subst">&#123;pc:04X&#125;</span>] LOAD  R<span class="subst">&#123;dst_reg&#125;</span> = [R<span class="subst">&#123;addr_reg&#125;</span>]&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_vm_input</span>(<span class="params">bytecode, pc</span>):</span><br><span class="line">    reg = bytecode[pc + <span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;[0x<span class="subst">&#123;pc:04X&#125;</span>] INPUT R<span class="subst">&#123;reg&#125;</span> = getchar()&quot;</span>, pc + <span class="number">6</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    filename = <span class="string">&quot;bin&quot;</span>  <span class="comment"># file binary cần disassemble</span></span><br><span class="line">    output_file = <span class="string">&quot;vm.txt&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        bytecode = <span class="built_in">list</span>(f.read())</span><br><span class="line"></span><br><span class="line">    lines = []</span><br><span class="line">    pc = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> pc + <span class="number">5</span> &lt; <span class="built_in">len</span>(bytecode):</span><br><span class="line">        op = bytecode[pc]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> op == <span class="number">0x00</span>:</span><br><span class="line">            line = parse_vm_add(bytecode, pc)</span><br><span class="line">        <span class="keyword">elif</span> op == <span class="number">0x01</span>:</span><br><span class="line">            line = parse_vm_addi(bytecode, pc)</span><br><span class="line">        <span class="keyword">elif</span> op == <span class="number">0x02</span>:</span><br><span class="line">            line = parse_vm_sub(bytecode, pc)</span><br><span class="line">        <span class="keyword">elif</span> op == <span class="number">0x03</span>:</span><br><span class="line">            line = parse_vm_subi(bytecode, pc)</span><br><span class="line">        <span class="keyword">elif</span> op == <span class="number">0x04</span>:</span><br><span class="line">            line = parse_vm_mul(bytecode, pc)</span><br><span class="line">        <span class="keyword">elif</span> op == <span class="number">0x05</span>:</span><br><span class="line">            line = parse_vm_muli(bytecode, pc)</span><br><span class="line">        <span class="keyword">elif</span> op == <span class="number">0x06</span>:</span><br><span class="line">            line = parse_vm_div(bytecode, pc)</span><br><span class="line">        <span class="keyword">elif</span> op == <span class="number">0x07</span>:</span><br><span class="line">            line = parse_vm_cmp(bytecode, pc)</span><br><span class="line">        <span class="keyword">elif</span> op == <span class="number">0x08</span>:</span><br><span class="line">            line = parse_vm_jmp(bytecode, pc)</span><br><span class="line">        <span class="keyword">elif</span> op == <span class="number">0x09</span>:</span><br><span class="line">            line = parse_vm_inv(bytecode, pc)</span><br><span class="line">        <span class="keyword">elif</span> op == <span class="number">0x0a</span>:</span><br><span class="line">            line = parse_vm_push(bytecode, pc)</span><br><span class="line">        <span class="keyword">elif</span> op == <span class="number">0x0b</span>:</span><br><span class="line">            line = parse_vm_pop(bytecode, pc)</span><br><span class="line">        <span class="keyword">elif</span> op == <span class="number">0x0c</span>:</span><br><span class="line">            line = parse_vm_mov(bytecode, pc)</span><br><span class="line">        <span class="keyword">elif</span> op == <span class="number">0xd</span>:</span><br><span class="line">            line = parse_vm_nop(bytecode, pc)</span><br><span class="line">        <span class="keyword">elif</span> op == <span class="number">0xe</span>:</span><br><span class="line">            line = parse_vm_exit(bytecode, pc)</span><br><span class="line">        <span class="keyword">elif</span> op == <span class="number">0xf</span>:</span><br><span class="line">            line = parse_vm_print(bytecode, pc)</span><br><span class="line">        <span class="keyword">elif</span> op == <span class="number">0x10</span>:</span><br><span class="line">            line = parse_vm_putc(bytecode, pc)</span><br><span class="line">        <span class="keyword">elif</span> op == <span class="number">0x11</span>:</span><br><span class="line">            line = parse_vm_je(bytecode, pc)</span><br><span class="line">        <span class="keyword">elif</span> op == <span class="number">0x12</span>:</span><br><span class="line">            line = parse_vm_jne(bytecode, pc)</span><br><span class="line">        <span class="keyword">elif</span> op == <span class="number">0x13</span>:</span><br><span class="line">            line = parse_vm_jle(bytecode, pc)</span><br><span class="line">        <span class="keyword">elif</span> op == <span class="number">0x14</span>:</span><br><span class="line">            line = parse_vm_jge(bytecode, pc)</span><br><span class="line">        <span class="keyword">elif</span> op == <span class="number">0x15</span>:</span><br><span class="line">            line = parse_vm_xor(bytecode, pc)</span><br><span class="line">        <span class="keyword">elif</span> op == <span class="number">0x16</span>:</span><br><span class="line">            line =parse_vm_store(bytecode, pc)</span><br><span class="line">        <span class="keyword">elif</span> op == <span class="number">0x17</span>: line = parse_vm_load(bytecode, pc)</span><br><span class="line">        <span class="keyword">elif</span> op == <span class="number">0x18</span>: line = parse_vm_input(bytecode, pc)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            line = <span class="string">f&quot;[0x<span class="subst">&#123;pc:04X&#125;</span>] UNKNOWN OPCODE 0x<span class="subst">&#123;op:02X&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(line)        <span class="comment"># In ra màn hình</span></span><br><span class="line">        lines.append(line) <span class="comment"># Lưu vào list để ghi file</span></span><br><span class="line"></span><br><span class="line">        pc += <span class="number">6</span>  <span class="comment"># luôn nhảy 6 byte</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Ghi ra file</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(output_file, <span class="string">&quot;w&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(<span class="string">&quot;\n&quot;</span>.join(lines))</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;\n✅ Đã ghi kết quả vào <span class="subst">&#123;output_file&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<ul>
<li>After I ran the tool, the interpreter came out, but there was a problem: opcode 0x55 was an error.<blockquote>
<p>[0x02C4] UNKNOWN OPCODE 0x55</p>
</blockquote>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br></pre></td><td class="code"><pre><span class="line">[0x004E] PUTC  &#x27;e&#x27;  (0x65)</span><br><span class="line">[0x0054] PUTC  &#x27;r&#x27;  (0x72)</span><br><span class="line">[0x005A] PUTC  &#x27;m&#x27;  (0x6D)</span><br><span class="line">[0x0060] PUTC  &#x27;i&#x27;  (0x69)</span><br><span class="line">[0x0066] PUTC  &#x27;n&#x27;  (0x6E)</span><br><span class="line">[0x006C] PUTC  &#x27;a&#x27;  (0x61)</span><br><span class="line">[0x0072] PUTC  &#x27;l&#x27;  (0x6C)</span><br><span class="line">[0x0078] PUTC  &#x27;]&#x27;  (0x5D)</span><br><span class="line">[0x007E] PUTC  &#x27;\x0a&#x27;  (0x0A)</span><br><span class="line">[0x0084] PUTC  &#x27;&lt;&#x27;  (0x3C)</span><br><span class="line">[0x008A] PUTC  &#x27; &#x27;  (0x20)</span><br><span class="line">[0x0090] PUTC  &#x27;E&#x27;  (0x45)</span><br><span class="line">[0x0096] PUTC  &#x27;n&#x27;  (0x6E)</span><br><span class="line">[0x009C] PUTC  &#x27;t&#x27;  (0x74)</span><br><span class="line">[0x00A2] PUTC  &#x27;e&#x27;  (0x65)</span><br><span class="line">[0x00A8] PUTC  &#x27;r&#x27;  (0x72)</span><br><span class="line">[0x00AE] PUTC  &#x27; &#x27;  (0x20)</span><br><span class="line">[0x00B4] PUTC  &#x27;k&#x27;  (0x6B)</span><br><span class="line">[0x00BA] PUTC  &#x27;e&#x27;  (0x65)</span><br><span class="line">[0x00C0] PUTC  &#x27;y&#x27;  (0x79)</span><br><span class="line">[0x00C6] PUTC  &#x27;c&#x27;  (0x63)</span><br><span class="line">[0x00CC] PUTC  &#x27;o&#x27;  (0x6F)</span><br><span class="line">[0x00D2] PUTC  &#x27;d&#x27;  (0x64)</span><br><span class="line">[0x00D8] PUTC  &#x27;e&#x27;  (0x65)</span><br><span class="line">[0x00DE] PUTC  &#x27; &#x27;  (0x20)</span><br><span class="line">[0x00E4] PUTC  &#x27;\x0a&#x27;  (0x0A)</span><br><span class="line">[0x00EA] PUTC  &#x27;&gt;&#x27;  (0x3E)</span><br><span class="line">[0x00F0] PUTC  &#x27; &#x27;  (0x20)</span><br><span class="line">[0x00F6] MOV   R30 = 4000</span><br><span class="line">[0x00FC] MOV   R28 = 0</span><br><span class="line">[0x0102] MOV   R29 = 17</span><br><span class="line">[0x0108] INPUT R25 = getchar()</span><br><span class="line">[0x010E] STORE [R30] = R25</span><br><span class="line">[0x0114] ADDI  R30 = R30 + 1</span><br><span class="line">[0x011A] ADDI  R28 = R28 + 1</span><br><span class="line">[0x0120] JLE   R28 &lt;= R29 -&gt; jump to 0x10e</span><br><span class="line">[0x0126] MOV   R30 = 4100</span><br><span class="line">[0x012C] MOV   R31 = 4000</span><br><span class="line">[0x0132] MOV   R28 = 0</span><br><span class="line">[0x0138] MOV   R29 = 10</span><br><span class="line">[0x013E] MOV   R27 = 169</span><br><span class="line">[0x0144] MOV   R23 = 0</span><br><span class="line">[0x014A] LOAD  R25 = [R30]</span><br><span class="line">[0x0150] LOAD  R24 = [R31]</span><br><span class="line">[0x0156] XOR   R25 = R25 ^ R27</span><br><span class="line">[0x015C] JE    R25 == R24 -&gt; jump to 0x1d4</span><br><span class="line">[0x0162] PUTC  &#x27;U&#x27;  (0x55)</span><br><span class="line">[0x0168] PUTC  &#x27;n&#x27;  (0x6E)</span><br><span class="line">[0x016E] PUTC  &#x27;k&#x27;  (0x6B)</span><br><span class="line">[0x0174] PUTC  &#x27;n&#x27;  (0x6E)</span><br><span class="line">[0x017A] PUTC  &#x27;o&#x27;  (0x6F)</span><br><span class="line">[0x0180] PUTC  &#x27;w&#x27;  (0x77)</span><br><span class="line">[0x0186] PUTC  &#x27;n&#x27;  (0x6E)</span><br><span class="line">[0x018C] PUTC  &#x27; &#x27;  (0x20)</span><br><span class="line">[0x0192] PUTC  &#x27;k&#x27;  (0x6B)</span><br><span class="line">[0x0198] PUTC  &#x27;e&#x27;  (0x65)</span><br><span class="line">[0x019E] PUTC  &#x27;y&#x27;  (0x79)</span><br><span class="line">[0x01A4] PUTC  &#x27;c&#x27;  (0x63)</span><br><span class="line">[0x01AA] PUTC  &#x27;o&#x27;  (0x6F)</span><br><span class="line">[0x01B0] PUTC  &#x27;d&#x27;  (0x64)</span><br><span class="line">[0x01B6] PUTC  &#x27;e&#x27;  (0x65)</span><br><span class="line">[0x01BC] PUTC  &#x27;!&#x27;  (0x21)</span><br><span class="line">[0x01C2] PUTC  &#x27;\x0a&#x27;  (0x0A)</span><br><span class="line">[0x01C8] EXIT</span><br><span class="line">[0x01CE] ADDI  R30 = R30 + 1</span><br><span class="line">[0x01D4] ADDI  R31 = R31 + 1</span><br><span class="line">[0x01DA] ADDI  R28 = R28 + 1</span><br><span class="line">[0x01E0] JLE   R28 &lt;= R29 -&gt; jump to 0x150</span><br><span class="line">[0x01E6] MOV   R15 = 0</span><br><span class="line">[0x01EC] PUSH  R15</span><br><span class="line">[0x01F2] PUSH  R15</span><br><span class="line">[0x01F8] PUSH  R15</span><br><span class="line">[0x01FE] INV   syscall(101, argc=3)</span><br><span class="line">[0x0204] MOV   R16 = 0</span><br><span class="line">[0x020A] JE    R31 == R16 -&gt; jump to 0x288</span><br><span class="line">[0x0210] PUTC  &#x27;T&#x27;  (0x54)</span><br><span class="line">[0x0216] PUTC  &#x27;e&#x27;  (0x65)</span><br><span class="line">[0x021C] PUTC  &#x27;r&#x27;  (0x72)</span><br><span class="line">[0x0222] PUTC  &#x27;m&#x27;  (0x6D)</span><br><span class="line">[0x0228] PUTC  &#x27;i&#x27;  (0x69)</span><br><span class="line">[0x022E] PUTC  &#x27;n&#x27;  (0x6E)</span><br><span class="line">[0x0234] PUTC  &#x27;a&#x27;  (0x61)</span><br><span class="line">[0x023A] PUTC  &#x27;l&#x27;  (0x6C)</span><br><span class="line">[0x0240] PUTC  &#x27; &#x27;  (0x20)</span><br><span class="line">[0x0246] PUTC  &#x27;b&#x27;  (0x62)</span><br><span class="line">[0x024C] PUTC  &#x27;l&#x27;  (0x6C)</span><br><span class="line">[0x0252] PUTC  &#x27;o&#x27;  (0x6F)</span><br><span class="line">[0x0258] PUTC  &#x27;c&#x27;  (0x63)</span><br><span class="line">[0x025E] PUTC  &#x27;k&#x27;  (0x6B)</span><br><span class="line">[0x0264] PUTC  &#x27;e&#x27;  (0x65)</span><br><span class="line">[0x026A] PUTC  &#x27;d&#x27;  (0x64)</span><br><span class="line">[0x0270] PUTC  &#x27;!&#x27;  (0x21)</span><br><span class="line">[0x0276] PUTC  &#x27;\x0a&#x27;  (0x0A)</span><br><span class="line">[0x027C] EXIT</span><br><span class="line">[0x0282] MOV   R30 = 119</span><br><span class="line">[0x0288] MULI  R30 = R30 * 6</span><br><span class="line">[0x028E] MOV   R28 = 0</span><br><span class="line">[0x0294] MOV   R29 = 1500</span><br><span class="line">[0x029A] MOV   R27 = 69</span><br><span class="line">[0x02A0] LOAD  R25 = [R30]</span><br><span class="line">[0x02A6] XOR   R25 = R25 ^ R27</span><br><span class="line">[0x02AC] STORE [R30] = R25</span><br><span class="line">[0x02B2] ADDI  R30 = R30 + 1</span><br><span class="line">[0x02B8] ADDI  R28 = R28 + 1</span><br><span class="line">[0x02BE] JLE   R28 &lt;= R29 -&gt; jump to 0x2a6</span><br><span class="line">[0x02C4] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x02CA] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x02D0] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x02D6] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x02DC] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x02E2] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x02E8] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x02EE] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x02F4] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x02FA] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x0300] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x0306] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x030C] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x0312] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x0318] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x031E] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x0324] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x032A] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x0330] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x0336] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x033C] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x0342] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x0348] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x034E] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x0354] UNKNOWN OPCODE 0x49</span><br><span class="line">[0x035A] UNKNOWN OPCODE 0x49</span><br><span class="line">[0x0360] UNKNOWN OPCODE 0x49</span><br><span class="line">[0x0366] UNKNOWN OPCODE 0x5D</span><br><span class="line">[0x036C] UNKNOWN OPCODE 0x53</span><br><span class="line">[0x0372] UNKNOWN OPCODE 0x44</span><br><span class="line">[0x0378] UNKNOWN OPCODE 0x44</span><br><span class="line">[0x037E] UNKNOWN OPCODE 0x56</span><br><span class="line">[0x0384] UNKNOWN OPCODE 0x49</span><br><span class="line">[0x038A] UNKNOWN OPCODE 0x49</span><br><span class="line">[0x0390] UNKNOWN OPCODE 0x49</span><br><span class="line">[0x0396] UNKNOWN OPCODE 0x49</span><br><span class="line">[0x039C] UNKNOWN OPCODE 0x49</span><br><span class="line">[0x03A2] UNKNOWN OPCODE 0x49</span><br><span class="line">[0x03A8] UNKNOWN OPCODE 0x52</span><br><span class="line">[0x03AE] UNKNOWN OPCODE 0x52</span><br><span class="line">[0x03B4] UNKNOWN OPCODE 0x4F</span><br><span class="line">[0x03BA] UNKNOWN OPCODE 0x4E</span><br><span class="line">[0x03C0] UNKNOWN OPCODE 0x49</span><br><span class="line">[0x03C6] UNKNOWN OPCODE 0x45</span><br><span class="line">[0x03CC] UNKNOWN OPCODE 0x52</span><br><span class="line">[0x03D2] UNKNOWN OPCODE 0x53</span><br><span class="line">[0x03D8] UNKNOWN OPCODE 0x53</span><br><span class="line">[0x03DE] UNKNOWN OPCODE 0x44</span><br><span class="line">[0x03E4] UNKNOWN OPCODE 0x44</span><br><span class="line">[0x03EA] UNKNOWN OPCODE 0x44</span><br><span class="line">[0x03F0] UNKNOWN OPCODE 0x56</span><br><span class="line">[0x03F6] UNKNOWN OPCODE 0x49</span><br><span class="line">[0x03FC] UNKNOWN OPCODE 0x49</span><br><span class="line">[0x0402] UNKNOWN OPCODE 0x49</span><br><span class="line">[0x0408] UNKNOWN OPCODE 0x49</span><br><span class="line">[0x040E] UNKNOWN OPCODE 0x52</span><br><span class="line">[0x0414] UNKNOWN OPCODE 0x4F</span><br><span class="line">[0x041A] UNKNOWN OPCODE 0x4E</span><br><span class="line">[0x0420] UNKNOWN OPCODE 0x45</span><br><span class="line">[0x0426] UNKNOWN OPCODE 0x52</span><br><span class="line">[0x042C] UNKNOWN OPCODE 0x50</span><br><span class="line">[0x0432] UNKNOWN OPCODE 0x53</span><br><span class="line">[0x0438] UNKNOWN OPCODE 0x44</span><br><span class="line">[0x043E] UNKNOWN OPCODE 0x44</span><br><span class="line">[0x0444] UNKNOWN OPCODE 0x56</span><br><span class="line">[0x044A] UNKNOWN OPCODE 0x44</span><br><span class="line">[0x0450] UNKNOWN OPCODE 0x56</span><br><span class="line">[0x0456] UNKNOWN OPCODE 0x49</span><br><span class="line">[0x045C] UNKNOWN OPCODE 0x49</span><br><span class="line">[0x0462] UNKNOWN OPCODE 0x49</span><br><span class="line">[0x0468] UNKNOWN OPCODE 0x49</span><br><span class="line">[0x046E] UNKNOWN OPCODE 0x52</span><br><span class="line">[0x0474] UNKNOWN OPCODE 0x52</span><br><span class="line">[0x047A] UNKNOWN OPCODE 0x54</span><br><span class="line">[0x0480] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x0486] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x048C] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x0492] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x0498] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x049E] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x04A4] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x04AA] UNKNOWN OPCODE 0x4B</span><br><span class="line">[0x04B0] UNKNOWN OPCODE 0x44</span><br><span class="line">[0x04B6] UNKNOWN OPCODE 0x44</span><br><span class="line">[0x04BC] UNKNOWN OPCODE 0x44</span><br><span class="line">[0x04C2] UNKNOWN OPCODE 0x56</span><br><span class="line">[0x04C8] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x04CE] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x04D4] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x04DA] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x04E0] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x04E6] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x04EC] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x04F2] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x04F8] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x04FE] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x0504] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x050A] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x0510] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x0516] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x051C] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x0522] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x0528] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x052E] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x0534] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x053A] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x0540] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x0546] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x054C] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x0552] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x0558] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x055E] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x0564] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x056A] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x0570] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x0576] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x057C] UNKNOWN OPCODE 0x55</span><br><span class="line">[0x0582] UNKNOWN OPCODE 0x4B</span><br></pre></td></tr></table></figure>

<ul>
<li>In this section, opcodes starting from 0x55 will be decoded and XORed with 69 before being executed.</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[0x0282] MOV   R30 = 119</span><br><span class="line">[0x0288] MULI  R30 = R30 * 6</span><br><span class="line">[0x028E] MOV   R28 = 0</span><br><span class="line">[0x0294] MOV   R29 = 1500</span><br><span class="line">[0x029A] MOV   R27 = 69</span><br><span class="line">[0x02A0] LOAD  R25 = [R30]</span><br><span class="line">[0x02A6] XOR   R25 = R25 ^ R27</span><br><span class="line">[0x02AC] STORE [R30] = R25</span><br><span class="line">[0x02B2] ADDI  R30 = R30 + 1</span><br><span class="line">[0x02B8] ADDI  R28 = R28 + 1</span><br><span class="line">[0x02BE] JLE   R28 &lt;= R29 -&gt; jump to 0x2a6</span><br></pre></td></tr></table></figure>

<p><img src="https://hackmd.io/_uploads/BJfh1Sjdgx.png" alt="image"></p>
<ul>
<li>After<br><img src="https://hackmd.io/_uploads/HJR1gHiOee.png" alt="image"></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br></pre></td><td class="code"><pre><span class="line">[0x0000] PUTC  &#x27;M&#x27;  (0x4D)</span><br><span class="line">[0x0006] PUTC  &#x27;a&#x27;  (0x61)</span><br><span class="line">[0x000C] PUTC  &#x27;i&#x27;  (0x69)</span><br><span class="line">[0x0012] PUTC  &#x27;n&#x27;  (0x6E)</span><br><span class="line">[0x0018] PUTC  &#x27; &#x27;  (0x20)</span><br><span class="line">[0x001E] PUTC  &#x27;V&#x27;  (0x56)</span><br><span class="line">[0x0024] PUTC  &#x27;e&#x27;  (0x65)</span><br><span class="line">[0x002A] PUTC  &#x27;s&#x27;  (0x73)</span><br><span class="line">[0x0030] PUTC  &#x27;s&#x27;  (0x73)</span><br><span class="line">[0x0036] PUTC  &#x27;e&#x27;  (0x65)</span><br><span class="line">[0x003C] PUTC  &#x27;l&#x27;  (0x6C)</span><br><span class="line">[0x0042] PUTC  &#x27; &#x27;  (0x20)</span><br><span class="line">[0x0048] PUTC  &#x27;T&#x27;  (0x54)</span><br><span class="line">[0x004E] PUTC  &#x27;e&#x27;  (0x65)</span><br><span class="line">[0x0054] PUTC  &#x27;r&#x27;  (0x72)</span><br><span class="line">[0x005A] PUTC  &#x27;m&#x27;  (0x6D)</span><br><span class="line">[0x0060] PUTC  &#x27;i&#x27;  (0x69)</span><br><span class="line">[0x0066] PUTC  &#x27;n&#x27;  (0x6E)</span><br><span class="line">[0x006C] PUTC  &#x27;a&#x27;  (0x61)</span><br><span class="line">[0x0072] PUTC  &#x27;l&#x27;  (0x6C)</span><br><span class="line">[0x0078] PUTC  &#x27;]&#x27;  (0x5D)</span><br><span class="line">[0x007E] PUTC  &#x27;\x0a&#x27;  (0x0A)</span><br><span class="line">[0x0084] PUTC  &#x27;&lt;&#x27;  (0x3C)</span><br><span class="line">[0x008A] PUTC  &#x27; &#x27;  (0x20)</span><br><span class="line">[0x0090] PUTC  &#x27;E&#x27;  (0x45)</span><br><span class="line">[0x0096] PUTC  &#x27;n&#x27;  (0x6E)</span><br><span class="line">[0x009C] PUTC  &#x27;t&#x27;  (0x74)</span><br><span class="line">[0x00A2] PUTC  &#x27;e&#x27;  (0x65)</span><br><span class="line">[0x00A8] PUTC  &#x27;r&#x27;  (0x72)</span><br><span class="line">[0x00AE] PUTC  &#x27; &#x27;  (0x20)</span><br><span class="line">[0x00B4] PUTC  &#x27;k&#x27;  (0x6B)</span><br><span class="line">[0x00BA] PUTC  &#x27;e&#x27;  (0x65)</span><br><span class="line">[0x00C0] PUTC  &#x27;y&#x27;  (0x79)</span><br><span class="line">[0x00C6] PUTC  &#x27;c&#x27;  (0x63)</span><br><span class="line">[0x00CC] PUTC  &#x27;o&#x27;  (0x6F)</span><br><span class="line">[0x00D2] PUTC  &#x27;d&#x27;  (0x64)</span><br><span class="line">[0x00D8] PUTC  &#x27;e&#x27;  (0x65)</span><br><span class="line">[0x00DE] PUTC  &#x27; &#x27;  (0x20)</span><br><span class="line">[0x00E4] PUTC  &#x27;\x0a&#x27;  (0x0A)</span><br><span class="line">[0x00EA] PUTC  &#x27;&gt;&#x27;  (0x3E)</span><br><span class="line">[0x00F0] PUTC  &#x27; &#x27;  (0x20)</span><br><span class="line">[0x00F6] MOV   R30 = 4000</span><br><span class="line">[0x00FC] MOV   R28 = 0</span><br><span class="line">[0x0102] MOV   R29 = 17</span><br><span class="line">[0x0108] INPUT R25 = getchar()</span><br><span class="line">[0x010E] STORE [R30] = R25</span><br><span class="line">[0x0114] ADDI  R30 = R30 + 1</span><br><span class="line">[0x011A] ADDI  R28 = R28 + 1</span><br><span class="line">[0x0120] JLE   R28 &lt;= R29 -&gt; jump to 0x10e</span><br><span class="line">[0x0126] MOV   R30 = 4100</span><br><span class="line">[0x012C] MOV   R31 = 4000</span><br><span class="line">[0x0132] MOV   R28 = 0</span><br><span class="line">[0x0138] MOV   R29 = 10</span><br><span class="line">[0x013E] MOV   R27 = 169</span><br><span class="line">[0x0144] MOV   R23 = 0</span><br><span class="line">[0x014A] LOAD  R25 = [R30]</span><br><span class="line">[0x0150] LOAD  R24 = [R31]</span><br><span class="line">[0x0156] XOR   R25 = R25 ^ R27</span><br><span class="line">[0x015C] JE    R25 == R24 -&gt; jump to 0x1d4</span><br><span class="line">[0x0162] PUTC  &#x27;U&#x27;  (0x55)</span><br><span class="line">[0x0168] PUTC  &#x27;n&#x27;  (0x6E)</span><br><span class="line">[0x016E] PUTC  &#x27;k&#x27;  (0x6B)</span><br><span class="line">[0x0174] PUTC  &#x27;n&#x27;  (0x6E)</span><br><span class="line">[0x017A] PUTC  &#x27;o&#x27;  (0x6F)</span><br><span class="line">[0x0180] PUTC  &#x27;w&#x27;  (0x77)</span><br><span class="line">[0x0186] PUTC  &#x27;n&#x27;  (0x6E)</span><br><span class="line">[0x018C] PUTC  &#x27; &#x27;  (0x20)</span><br><span class="line">[0x0192] PUTC  &#x27;k&#x27;  (0x6B)</span><br><span class="line">[0x0198] PUTC  &#x27;e&#x27;  (0x65)</span><br><span class="line">[0x019E] PUTC  &#x27;y&#x27;  (0x79)</span><br><span class="line">[0x01A4] PUTC  &#x27;c&#x27;  (0x63)</span><br><span class="line">[0x01AA] PUTC  &#x27;o&#x27;  (0x6F)</span><br><span class="line">[0x01B0] PUTC  &#x27;d&#x27;  (0x64)</span><br><span class="line">[0x01B6] PUTC  &#x27;e&#x27;  (0x65)</span><br><span class="line">[0x01BC] PUTC  &#x27;!&#x27;  (0x21)</span><br><span class="line">[0x01C2] PUTC  &#x27;\x0a&#x27;  (0x0A)</span><br><span class="line">[0x01C8] EXIT</span><br><span class="line">[0x01CE] ADDI  R30 = R30 + 1</span><br><span class="line">[0x01D4] ADDI  R31 = R31 + 1</span><br><span class="line">[0x01DA] ADDI  R28 = R28 + 1</span><br><span class="line">[0x01E0] JLE   R28 &lt;= R29 -&gt; jump to 0x150</span><br><span class="line">[0x01E6] MOV   R15 = 0</span><br><span class="line">[0x01EC] PUSH  R15</span><br><span class="line">[0x01F2] PUSH  R15</span><br><span class="line">[0x01F8] PUSH  R15</span><br><span class="line">[0x01FE] INV   syscall(101, argc=3)</span><br><span class="line">[0x0204] MOV   R16 = 0</span><br><span class="line">[0x020A] JE    R31 == R16 -&gt; jump to 0x288</span><br><span class="line">[0x0210] PUTC  &#x27;T&#x27;  (0x54)</span><br><span class="line">[0x0216] PUTC  &#x27;e&#x27;  (0x65)</span><br><span class="line">[0x021C] PUTC  &#x27;r&#x27;  (0x72)</span><br><span class="line">[0x0222] PUTC  &#x27;m&#x27;  (0x6D)</span><br><span class="line">[0x0228] PUTC  &#x27;i&#x27;  (0x69)</span><br><span class="line">[0x022E] PUTC  &#x27;n&#x27;  (0x6E)</span><br><span class="line">[0x0234] PUTC  &#x27;a&#x27;  (0x61)</span><br><span class="line">[0x023A] PUTC  &#x27;l&#x27;  (0x6C)</span><br><span class="line">[0x0240] PUTC  &#x27; &#x27;  (0x20)</span><br><span class="line">[0x0246] PUTC  &#x27;b&#x27;  (0x62)</span><br><span class="line">[0x024C] PUTC  &#x27;l&#x27;  (0x6C)</span><br><span class="line">[0x0252] PUTC  &#x27;o&#x27;  (0x6F)</span><br><span class="line">[0x0258] PUTC  &#x27;c&#x27;  (0x63)</span><br><span class="line">[0x025E] PUTC  &#x27;k&#x27;  (0x6B)</span><br><span class="line">[0x0264] PUTC  &#x27;e&#x27;  (0x65)</span><br><span class="line">[0x026A] PUTC  &#x27;d&#x27;  (0x64)</span><br><span class="line">[0x0270] PUTC  &#x27;!&#x27;  (0x21)</span><br><span class="line">[0x0276] PUTC  &#x27;\x0a&#x27;  (0x0A)</span><br><span class="line">[0x027C] EXIT</span><br><span class="line">[0x0282] MOV   R30 = 119</span><br><span class="line">[0x0288] MULI  R30 = R30 * 6</span><br><span class="line">[0x028E] MOV   R28 = 0</span><br><span class="line">[0x0294] MOV   R29 = 1500</span><br><span class="line">[0x029A] MOV   R27 = 69</span><br><span class="line">[0x02A0] LOAD  R25 = [R30]</span><br><span class="line">[0x02A6] XOR   R25 = R25 ^ R27</span><br><span class="line">[0x02AC] STORE [R30] = R25</span><br><span class="line">[0x02B2] ADDI  R30 = R30 + 1</span><br><span class="line">[0x02B8] ADDI  R28 = R28 + 1</span><br><span class="line">[0x02BE] JLE   R28 &lt;= R29 -&gt; jump to 0x2a6</span><br><span class="line">[0x02C4] PUTC  &#x27;&lt;&#x27;  (0x3C)</span><br><span class="line">[0x02CA] PUTC  &#x27; &#x27;  (0x20)</span><br><span class="line">[0x02D0] PUTC  &#x27;E&#x27;  (0x45)</span><br><span class="line">[0x02D6] PUTC  &#x27;n&#x27;  (0x6E)</span><br><span class="line">[0x02DC] PUTC  &#x27;t&#x27;  (0x74)</span><br><span class="line">[0x02E2] PUTC  &#x27;e&#x27;  (0x65)</span><br><span class="line">[0x02E8] PUTC  &#x27;r&#x27;  (0x72)</span><br><span class="line">[0x02EE] PUTC  &#x27; &#x27;  (0x20)</span><br><span class="line">[0x02F4] PUTC  &#x27;s&#x27;  (0x73)</span><br><span class="line">[0x02FA] PUTC  &#x27;e&#x27;  (0x65)</span><br><span class="line">[0x0300] PUTC  &#x27;c&#x27;  (0x63)</span><br><span class="line">[0x0306] PUTC  &#x27;r&#x27;  (0x72)</span><br><span class="line">[0x030C] PUTC  &#x27;e&#x27;  (0x65)</span><br><span class="line">[0x0312] PUTC  &#x27;t&#x27;  (0x74)</span><br><span class="line">[0x0318] PUTC  &#x27; &#x27;  (0x20)</span><br><span class="line">[0x031E] PUTC  &#x27;p&#x27;  (0x70)</span><br><span class="line">[0x0324] PUTC  &#x27;h&#x27;  (0x68)</span><br><span class="line">[0x032A] PUTC  &#x27;r&#x27;  (0x72)</span><br><span class="line">[0x0330] PUTC  &#x27;a&#x27;  (0x61)</span><br><span class="line">[0x0336] PUTC  &#x27;s&#x27;  (0x73)</span><br><span class="line">[0x033C] PUTC  &#x27;e&#x27;  (0x65)</span><br><span class="line">[0x0342] PUTC  &#x27;\x0a&#x27;  (0x0A)</span><br><span class="line">[0x0348] PUTC  &#x27;&gt;&#x27;  (0x3E)</span><br><span class="line">[0x034E] PUTC  &#x27; &#x27;  (0x20)</span><br><span class="line">[0x0354] MOV   R30 = 4400</span><br><span class="line">[0x035A] MOV   R28 = 0</span><br><span class="line">[0x0360] MOV   R29 = 36</span><br><span class="line">[0x0366] INPUT R25 = getchar()</span><br><span class="line">[0x036C] STORE [R30] = R25</span><br><span class="line">[0x0372] ADDI  R30 = R30 + 1</span><br><span class="line">[0x0378] ADDI  R28 = R28 + 1</span><br><span class="line">[0x037E] JLE   R28 &lt;= R29 -&gt; jump to 0x36c</span><br><span class="line">[0x0384] MOV   R28 = 0</span><br><span class="line">[0x038A] MOV   R29 = 35</span><br><span class="line">[0x0390] MOV   R30 = 4400</span><br><span class="line">[0x0396] MOV   R31 = 4500</span><br><span class="line">[0x039C] MOV   R26 = 0</span><br><span class="line">[0x03A2] MOV   R27 = 35</span><br><span class="line">[0x03A8] LOAD  R20 = [R30]</span><br><span class="line">[0x03AE] LOAD  R21 = [R31]</span><br><span class="line">[0x03B4] PUSH  R20</span><br><span class="line">[0x03BA] POP   R19</span><br><span class="line">[0x03C0] MOV   R18 = 4400</span><br><span class="line">[0x03C6] ADD   R18 = R18 + R21</span><br><span class="line">[0x03CC] LOAD  R17 = [R18]</span><br><span class="line">[0x03D2] STORE [R30] = R17</span><br><span class="line">[0x03D8] STORE [R18] = R19</span><br><span class="line">[0x03DE] ADDI  R26 = R26 + 1</span><br><span class="line">[0x03E4] ADDI  R30 = R30 + 1</span><br><span class="line">[0x03EA] ADDI  R31 = R31 + 1</span><br><span class="line">[0x03F0] JLE   R26 &lt;= R27 -&gt; jump to 0x3ae</span><br><span class="line">[0x03F6] MOV   R30 = 4400</span><br><span class="line">[0x03FC] MOV   R31 = 4600</span><br><span class="line">[0x0402] MOV   R26 = 0</span><br><span class="line">[0x0408] MOV   R27 = 35</span><br><span class="line">[0x040E] LOAD  R20 = [R30]</span><br><span class="line">[0x0414] PUSH  R31</span><br><span class="line">[0x041A] POP   R15</span><br><span class="line">[0x0420] ADD   R15 = R15 + R28</span><br><span class="line">[0x0426] LOAD  R16 = [R15]</span><br><span class="line">[0x042C] XOR   R20 = R20 ^ R16</span><br><span class="line">[0x0432] STORE [R30] = R20</span><br><span class="line">[0x0438] ADDI  R26 = R26 + 1</span><br><span class="line">[0x043E] ADDI  R30 = R30 + 1</span><br><span class="line">[0x0444] JLE   R26 &lt;= R27 -&gt; jump to 0x414</span><br><span class="line">[0x044A] ADDI  R28 = R28 + 1</span><br><span class="line">[0x0450] JLE   R28 &lt;= R29 -&gt; jump to 0x396</span><br><span class="line">[0x0456] MOV   R30 = 4400</span><br><span class="line">[0x045C] MOV   R31 = 4700</span><br><span class="line">[0x0462] MOV   R26 = 0</span><br><span class="line">[0x0468] MOV   R27 = 35</span><br><span class="line">[0x046E] LOAD  R15 = [R30]</span><br><span class="line">[0x0474] LOAD  R16 = [R31]</span><br><span class="line">[0x047A] JE    R15 == R16 -&gt; jump to 0x4b6</span><br><span class="line">[0x0480] PUTC  &#x27;W&#x27;  (0x57)</span><br><span class="line">[0x0486] PUTC  &#x27;r&#x27;  (0x72)</span><br><span class="line">[0x048C] PUTC  &#x27;o&#x27;  (0x6F)</span><br><span class="line">[0x0492] PUTC  &#x27;n&#x27;  (0x6E)</span><br><span class="line">[0x0498] PUTC  &#x27;g&#x27;  (0x67)</span><br><span class="line">[0x049E] PUTC  &#x27;!&#x27;  (0x21)</span><br><span class="line">[0x04A4] PUTC  &#x27;\x0a&#x27;  (0x0A)</span><br><span class="line">[0x04AA] EXIT</span><br><span class="line">[0x04B0] ADDI  R26 = R26 + 1</span><br><span class="line">[0x04B6] ADDI  R30 = R30 + 1</span><br><span class="line">[0x04BC] ADDI  R31 = R31 + 1</span><br><span class="line">[0x04C2] JLE   R26 &lt;= R27 -&gt; jump to 0x474</span><br><span class="line">[0x04C8] PUTC  &#x27;A&#x27;  (0x41)</span><br><span class="line">[0x04CE] PUTC  &#x27;c&#x27;  (0x63)</span><br><span class="line">[0x04D4] PUTC  &#x27;c&#x27;  (0x63)</span><br><span class="line">[0x04DA] PUTC  &#x27;e&#x27;  (0x65)</span><br><span class="line">[0x04E0] PUTC  &#x27;s&#x27;  (0x73)</span><br><span class="line">[0x04E6] PUTC  &#x27;s&#x27;  (0x73)</span><br><span class="line">[0x04EC] PUTC  &#x27; &#x27;  (0x20)</span><br><span class="line">[0x04F2] PUTC  &#x27;g&#x27;  (0x67)</span><br><span class="line">[0x04F8] PUTC  &#x27;r&#x27;  (0x72)</span><br><span class="line">[0x04FE] PUTC  &#x27;a&#x27;  (0x61)</span><br><span class="line">[0x0504] PUTC  &#x27;n&#x27;  (0x6E)</span><br><span class="line">[0x050A] PUTC  &#x27;t&#x27;  (0x74)</span><br><span class="line">[0x0510] PUTC  &#x27;e&#x27;  (0x65)</span><br><span class="line">[0x0516] PUTC  &#x27;d&#x27;  (0x64)</span><br><span class="line">[0x051C] PUTC  &#x27;,&#x27;  (0x2C)</span><br><span class="line">[0x0522] PUTC  &#x27; &#x27;  (0x20)</span><br><span class="line">[0x0528] PUTC  &#x27;s&#x27;  (0x73)</span><br><span class="line">[0x052E] PUTC  &#x27;h&#x27;  (0x68)</span><br><span class="line">[0x0534] PUTC  &#x27;u&#x27;  (0x75)</span><br><span class="line">[0x053A] PUTC  &#x27;t&#x27;  (0x74)</span><br><span class="line">[0x0540] PUTC  &#x27;t&#x27;  (0x74)</span><br><span class="line">[0x0546] PUTC  &#x27;i&#x27;  (0x69)</span><br><span class="line">[0x054C] PUTC  &#x27;n&#x27;  (0x6E)</span><br><span class="line">[0x0552] PUTC  &#x27;g&#x27;  (0x67)</span><br><span class="line">[0x0558] PUTC  &#x27; &#x27;  (0x20)</span><br><span class="line">[0x055E] PUTC  &#x27;d&#x27;  (0x64)</span><br><span class="line">[0x0564] PUTC  &#x27;o&#x27;  (0x6F)</span><br><span class="line">[0x056A] PUTC  &#x27;w&#x27;  (0x77)</span><br><span class="line">[0x0570] PUTC  &#x27;n&#x27;  (0x6E)</span><br><span class="line">[0x0576] PUTC  &#x27;!&#x27;  (0x21)</span><br><span class="line">[0x057C] PUTC  &#x27;\x0a&#x27;  (0x0A)</span><br><span class="line">[0x0582] EXIT</span><br></pre></td></tr></table></figure>

<ul>
<li>This is the main logic of the program which first requires the user to enter a keycode of up to 17 characters then XOR it with 0xA9 and compare it with the corresponding byte at address 4100.</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;bin.bak&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data = f.read()</span><br><span class="line"></span><br><span class="line">offset = <span class="number">4094</span></span><br><span class="line">length = <span class="number">17</span></span><br><span class="line">xor_key = <span class="number">0xA9</span></span><br><span class="line"></span><br><span class="line">key_bytes = data[offset:offset+length]</span><br><span class="line">decoded = <span class="built_in">bytes</span>([b ^ xor_key <span class="keyword">for</span> b <span class="keyword">in</span> key_bytes])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Keycode:&quot;</span>, decoded.decode(errors=<span class="string">&quot;replace&quot;</span>))</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Keycode: c0d3_r3d_5hutd0wn<br><img src="https://hackmd.io/_uploads/Bk3qZrouel.png" alt="image"></p>
</blockquote>
<ul>
<li>The next request made me enter secret phrase</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line">[0x02C4] PUTC  &#x27;&lt;&#x27;  (0x3C)</span><br><span class="line">[0x02CA] PUTC  &#x27; &#x27;  (0x20)</span><br><span class="line">[0x02D0] PUTC  &#x27;E&#x27;  (0x45)</span><br><span class="line">[0x02D6] PUTC  &#x27;n&#x27;  (0x6E)</span><br><span class="line">[0x02DC] PUTC  &#x27;t&#x27;  (0x74)</span><br><span class="line">[0x02E2] PUTC  &#x27;e&#x27;  (0x65)</span><br><span class="line">[0x02E8] PUTC  &#x27;r&#x27;  (0x72)</span><br><span class="line">[0x02EE] PUTC  &#x27; &#x27;  (0x20)</span><br><span class="line">[0x02F4] PUTC  &#x27;s&#x27;  (0x73)</span><br><span class="line">[0x02FA] PUTC  &#x27;e&#x27;  (0x65)</span><br><span class="line">[0x0300] PUTC  &#x27;c&#x27;  (0x63)</span><br><span class="line">[0x0306] PUTC  &#x27;r&#x27;  (0x72)</span><br><span class="line">[0x030C] PUTC  &#x27;e&#x27;  (0x65)</span><br><span class="line">[0x0312] PUTC  &#x27;t&#x27;  (0x74)</span><br><span class="line">[0x0318] PUTC  &#x27; &#x27;  (0x20)</span><br><span class="line">[0x031E] PUTC  &#x27;p&#x27;  (0x70)</span><br><span class="line">[0x0324] PUTC  &#x27;h&#x27;  (0x68)</span><br><span class="line">[0x032A] PUTC  &#x27;r&#x27;  (0x72)</span><br><span class="line">[0x0330] PUTC  &#x27;a&#x27;  (0x61)</span><br><span class="line">[0x0336] PUTC  &#x27;s&#x27;  (0x73)</span><br><span class="line">[0x033C] PUTC  &#x27;e&#x27;  (0x65)</span><br><span class="line">[0x0342] PUTC  &#x27;\x0a&#x27;  (0x0A)</span><br><span class="line">[0x0348] PUTC  &#x27;&gt;&#x27;  (0x3E)</span><br><span class="line">[0x034E] PUTC  &#x27; &#x27;  (0x20)</span><br><span class="line">[0x0354] MOV   R30 = 4400</span><br><span class="line">[0x035A] MOV   R28 = 0</span><br><span class="line">[0x0360] MOV   R29 = 36</span><br><span class="line">[0x0366] INPUT R25 = getchar()</span><br><span class="line">[0x036C] STORE [R30] = R25</span><br><span class="line">[0x0372] ADDI  R30 = R30 + 1</span><br><span class="line">[0x0378] ADDI  R28 = R28 + 1</span><br><span class="line">[0x037E] JLE   R28 &lt;= R29 -&gt; jump to 0x36c</span><br><span class="line">[0x0384] MOV   R28 = 0</span><br><span class="line">[0x038A] MOV   R29 = 35</span><br><span class="line">[0x0390] MOV   R30 = 4400</span><br><span class="line">[0x0396] MOV   R31 = 4500</span><br><span class="line">[0x039C] MOV   R26 = 0</span><br><span class="line">[0x03A2] MOV   R27 = 35</span><br><span class="line">[0x03A8] LOAD  R20 = [R30]</span><br><span class="line">[0x03AE] LOAD  R21 = [R31]</span><br><span class="line">[0x03B4] PUSH  R20</span><br><span class="line">[0x03BA] POP   R19</span><br><span class="line">[0x03C0] MOV   R18 = 4400</span><br><span class="line">[0x03C6] ADD   R18 = R18 + R21</span><br><span class="line">[0x03CC] LOAD  R17 = [R18]</span><br><span class="line">[0x03D2] STORE [R30] = R17</span><br><span class="line">[0x03D8] STORE [R18] = R19</span><br><span class="line">[0x03DE] ADDI  R26 = R26 + 1</span><br><span class="line">[0x03E4] ADDI  R30 = R30 + 1</span><br><span class="line">[0x03EA] ADDI  R31 = R31 + 1</span><br><span class="line">[0x03F0] JLE   R26 &lt;= R27 -&gt; jump to 0x3ae</span><br><span class="line">[0x03F6] MOV   R30 = 4400</span><br><span class="line">[0x03FC] MOV   R31 = 4600</span><br><span class="line">[0x0402] MOV   R26 = 0</span><br><span class="line">[0x0408] MOV   R27 = 35</span><br><span class="line">[0x040E] LOAD  R20 = [R30]</span><br><span class="line">[0x0414] PUSH  R31</span><br><span class="line">[0x041A] POP   R15</span><br><span class="line">[0x0420] ADD   R15 = R15 + R28</span><br><span class="line">[0x0426] LOAD  R16 = [R15]</span><br><span class="line">[0x042C] XOR   R20 = R20 ^ R16</span><br><span class="line">[0x0432] STORE [R30] = R20</span><br><span class="line">[0x0438] ADDI  R26 = R26 + 1</span><br><span class="line">[0x043E] ADDI  R30 = R30 + 1</span><br><span class="line">[0x0444] JLE   R26 &lt;= R27 -&gt; jump to 0x414</span><br><span class="line">[0x044A] ADDI  R28 = R28 + 1</span><br><span class="line">[0x0450] JLE   R28 &lt;= R29 -&gt; jump to 0x396</span><br><span class="line">[0x0456] MOV   R30 = 4400</span><br><span class="line">[0x045C] MOV   R31 = 4700</span><br><span class="line">[0x0462] MOV   R26 = 0</span><br><span class="line">[0x0468] MOV   R27 = 35</span><br><span class="line">[0x046E] LOAD  R15 = [R30]</span><br><span class="line">[0x0474] LOAD  R16 = [R31]</span><br><span class="line">[0x047A] JE    R15 == R16 -&gt; jump to 0x4b6</span><br><span class="line">[0x0480] PUTC  &#x27;W&#x27;  (0x57)</span><br><span class="line">[0x0486] PUTC  &#x27;r&#x27;  (0x72)</span><br><span class="line">[0x048C] PUTC  &#x27;o&#x27;  (0x6F)</span><br><span class="line">[0x0492] PUTC  &#x27;n&#x27;  (0x6E)</span><br><span class="line">[0x0498] PUTC  &#x27;g&#x27;  (0x67)</span><br><span class="line">[0x049E] PUTC  &#x27;!&#x27;  (0x21)</span><br><span class="line">[0x04A4] PUTC  &#x27;\x0a&#x27;  (0x0A)</span><br><span class="line">[0x04AA] EXIT</span><br><span class="line">[0x04B0] ADDI  R26 = R26 + 1</span><br><span class="line">[0x04B6] ADDI  R30 = R30 + 1</span><br><span class="line">[0x04BC] ADDI  R31 = R31 + 1</span><br><span class="line">[0x04C2] JLE   R26 &lt;= R27 -&gt; jump to 0x474</span><br><span class="line">[0x04C8] PUTC  &#x27;A&#x27;  (0x41)</span><br><span class="line">[0x04CE] PUTC  &#x27;c&#x27;  (0x63)</span><br><span class="line">[0x04D4] PUTC  &#x27;c&#x27;  (0x63)</span><br><span class="line">[0x04DA] PUTC  &#x27;e&#x27;  (0x65)</span><br><span class="line">[0x04E0] PUTC  &#x27;s&#x27;  (0x73)</span><br><span class="line">[0x04E6] PUTC  &#x27;s&#x27;  (0x73)</span><br><span class="line">[0x04EC] PUTC  &#x27; &#x27;  (0x20)</span><br><span class="line">[0x04F2] PUTC  &#x27;g&#x27;  (0x67)</span><br><span class="line">[0x04F8] PUTC  &#x27;r&#x27;  (0x72)</span><br><span class="line">[0x04FE] PUTC  &#x27;a&#x27;  (0x61)</span><br><span class="line">[0x0504] PUTC  &#x27;n&#x27;  (0x6E)</span><br><span class="line">[0x050A] PUTC  &#x27;t&#x27;  (0x74)</span><br><span class="line">[0x0510] PUTC  &#x27;e&#x27;  (0x65)</span><br><span class="line">[0x0516] PUTC  &#x27;d&#x27;  (0x64)</span><br><span class="line">[0x051C] PUTC  &#x27;,&#x27;  (0x2C)</span><br><span class="line">[0x0522] PUTC  &#x27; &#x27;  (0x20)</span><br><span class="line">[0x0528] PUTC  &#x27;s&#x27;  (0x73)</span><br><span class="line">[0x052E] PUTC  &#x27;h&#x27;  (0x68)</span><br><span class="line">[0x0534] PUTC  &#x27;u&#x27;  (0x75)</span><br><span class="line">[0x053A] PUTC  &#x27;t&#x27;  (0x74)</span><br><span class="line">[0x0540] PUTC  &#x27;t&#x27;  (0x74)</span><br><span class="line">[0x0546] PUTC  &#x27;i&#x27;  (0x69)</span><br><span class="line">[0x054C] PUTC  &#x27;n&#x27;  (0x6E)</span><br><span class="line">[0x0552] PUTC  &#x27;g&#x27;  (0x67)</span><br><span class="line">[0x0558] PUTC  &#x27; &#x27;  (0x20)</span><br><span class="line">[0x055E] PUTC  &#x27;d&#x27;  (0x64)</span><br><span class="line">[0x0564] PUTC  &#x27;o&#x27;  (0x6F)</span><br><span class="line">[0x056A] PUTC  &#x27;w&#x27;  (0x77)</span><br><span class="line">[0x0570] PUTC  &#x27;n&#x27;  (0x6E)</span><br><span class="line">[0x0576] PUTC  &#x27;!&#x27;  (0x21)</span><br><span class="line">[0x057C] PUTC  &#x27;\x0a&#x27;  (0x0A)</span><br><span class="line">[0x0582] EXIT</span><br></pre></td></tr></table></figure>

<ul>
<li><p>And this is the main processing part of it.</p>
</li>
<li><p>The secret phrase is a 36 byte string, tested by:</p>
</li>
<li><p>Permuting according to table [4500].</p>
</li>
<li><p>XORing with keystream [4600].</p>
</li>
<li><p>Comparing with ciphertext [4700].</p>
</li>
<li><p>To decrypt from cipher[36] → plain[36], we reverse the order:</p>
</li>
<li><p>Run back 36 rounds: j &#x3D; 35 → 0</p>
</li>
<li><p>Remove XOR: XOR all 36 bytes with K[j]</p>
</li>
<li><p>Remove swap: apply the same table T but in order i &#x3D; 35 → 0 (because swap is self-inverting, just reverse the order of operations)</p>
</li>
</ul>
<h2 id="🛠️-Solution"><a href="#🛠️-Solution" class="headerlink" title="🛠️ Solution"></a>🛠️ Solution</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># vm_phrase_decrypt.py</span></span><br><span class="line"><span class="comment"># Decrypt 36-byte phrase for the VM:</span></span><br><span class="line"><span class="comment"># Each round j=0..35: SWAP pass by table T (i=0..35), then XOR all bytes with K[j]</span></span><br><span class="line"><span class="comment"># To decrypt: run j=35..0, undo XOR, then undo SWAP pass (i=35..0)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">List</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_hex_bytes</span>(<span class="params">s: <span class="built_in">str</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    <span class="comment"># accepts strings like: &quot;31 5D 77 ...&quot; (hex, space-separated)</span></span><br><span class="line">    parts = s.strip().split()</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(<span class="built_in">int</span>(p, <span class="number">16</span>) <span class="keyword">for</span> p <span class="keyword">in</span> parts)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_hex_ints</span>(<span class="params">s: <span class="built_in">str</span></span>) -&gt; <span class="type">List</span>[<span class="built_in">int</span>]:</span><br><span class="line">    <span class="comment"># for swap table (indices 0..35, given in hex)</span></span><br><span class="line">    parts = s.strip().split()</span><br><span class="line">    <span class="keyword">return</span> [<span class="built_in">int</span>(p, <span class="number">16</span>) <span class="keyword">for</span> p <span class="keyword">in</span> parts]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">undo_one_round</span>(<span class="params">buf: <span class="built_in">bytearray</span>, T: <span class="type">List</span>[<span class="built_in">int</span>], kbyte: <span class="built_in">int</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">    <span class="comment"># Undo XOR</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(buf)):</span><br><span class="line">        buf[i] ^= kbyte</span><br><span class="line">    <span class="comment"># Undo SWAP pass (reverse order of the forward swaps)</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">reversed</span>(<span class="built_in">range</span>(<span class="built_in">len</span>(T))):</span><br><span class="line">        t = T[i]</span><br><span class="line">        buf[i], buf[t] = buf[t], buf[i]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_phrase</span>(<span class="params">cipher: <span class="built_in">bytes</span>, swap_table: <span class="type">List</span>[<span class="built_in">int</span>], keystream: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    n = <span class="number">36</span></span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(cipher) == n <span class="keyword">and</span> <span class="built_in">len</span>(swap_table) == n <span class="keyword">and</span> <span class="built_in">len</span>(keystream) == n</span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">all</span>(<span class="number">0</span> &lt;= x &lt; n <span class="keyword">for</span> x <span class="keyword">in</span> swap_table)</span><br><span class="line">    b = <span class="built_in">bytearray</span>(cipher)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n - <span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">        undo_one_round(b, swap_table, keystream[j])</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(b)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt_phrase</span>(<span class="params">plain: <span class="built_in">bytes</span>, swap_table: <span class="type">List</span>[<span class="built_in">int</span>], keystream: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    n = <span class="number">36</span></span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(plain) == n <span class="keyword">and</span> <span class="built_in">len</span>(swap_table) == n <span class="keyword">and</span> <span class="built_in">len</span>(keystream) == n</span><br><span class="line">    b = <span class="built_in">bytearray</span>(plain)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        <span class="comment"># forward SWAP pass</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">            t = swap_table[i]</span><br><span class="line">            b[i], b[t] = b[t], b[i]</span><br><span class="line">        <span class="comment"># XOR with keystream[j]</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">            b[i] ^= keystream[j]</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(b)</span><br><span class="line"></span><br><span class="line"><span class="comment"># --- Your data (from the VM memory dumps) ---</span></span><br><span class="line"></span><br><span class="line">swap_hex = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">13 19 0F 0A 07 00 1D 0E 16 10 0C 01 0B 1F 18 14 08 09 1C 1A 21 04 22 12 05 1B 11 20 06 02 15 17 0D 1E 23 03</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">key_hex = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">16 B0 47 B2 01 FB DE EB 82 5D 5B 5D 10 7C 6E 21 5F E7 45 2A 36 23 D4 D7 26 D5 A3 11 ED E7 5E CB DB 9F DD E2</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">cipher_hex = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">31 5D 77 4A 33 40 56 35 75 37 5D 35 6E 6E 66 32 6C 36 70 66 61 6A 31 79 5D 31 70 7F 6C 60 33 32 36 7B 31 5D</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">swap_table = parse_hex_ints(swap_hex)       <span class="comment"># 36 indices</span></span><br><span class="line">keystream = parse_hex_bytes(key_hex)        <span class="comment"># 36 bytes</span></span><br><span class="line">cipher = parse_hex_bytes(cipher_hex)        <span class="comment"># 36 bytes</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    plain = decrypt_phrase(cipher, swap_table, keystream)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Plain (ASCII):&quot;</span>, plain.decode(<span class="string">&#x27;utf-8&#x27;</span>, errors=<span class="string">&#x27;replace&#x27;</span>))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Plain (hex):  &quot;</span>, plain.<span class="built_in">hex</span>())</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Optional: verify by re-encrypting</span></span><br><span class="line">    check = encrypt_phrase(plain, swap_table, keystream)</span><br><span class="line">    <span class="keyword">assert</span> check == cipher, <span class="string">&quot;Re-encrypt check failed!&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Re-encrypt check: OK&quot;</span>)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>FLAG: HTB{5w1rl_4r0und_7h3_4l13n_by73c0d3}<br><img src="https://hackmd.io/_uploads/BkPzXHjule.png" alt="image"></p>
</blockquote>

        
      </div>

         
    </div>
    
     
  </div>
  
    
<nav id="article-nav">
  <a class="article-nav-btn left "
    
      href="/2025/08/19/E-commerce/"
      title="[Malware Analysis] E-commerce"
     >
    <i class="fa-solid fa-angle-left"></i>
    <p class="title-text">
      
        [Malware Analysis] E-commerce
        
    </p>
  </a>
  <a class="article-nav-btn right "
    
      href="/2025/08/18/ScriptCTF-2025/"
      title="Reverse/ScriptCTF 2025 (vm2)"
     >

    <p class="title-text">
      
        Reverse/ScriptCTF 2025 (vm2)
        
    </p>
    <i class="fa-solid fa-angle-right"></i>
  </a>
</nav>


  
</article>





    </div>
    <div id="footer-wrapper">
      <footer id="footer">
  
  <div id="footer-info" class="inner">
    
    &copy; 2025 nukoneZ<br>
    Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> & Theme <a target="_blank" rel="noopener" href="https://github.com/saicaca/hexo-theme-vivia">Vivia</a>
  </div>
</footer>

    </div>
    <div class="back-to-top-wrapper">
    <button id="back-to-top-btn" class="back-to-top-btn hide" onclick="topFunction()">
        <i class="fa-solid fa-angle-up"></i>
    </button>
</div>

<script>
    function topFunction() {
        window.scroll({ top: 0, behavior: 'smooth' });
    }
    let btn = document.getElementById('back-to-top-btn');
    function scrollFunction() {
        if (document.body.scrollTop > 600 || document.documentElement.scrollTop > 600) {
            btn.classList.remove('hide')
        } else {
            btn.classList.add('hide')
        }
    }
    window.onscroll = function() {
        scrollFunction();
    }
</script>

  </div>
  <script src="/js/light-dark-switch.js"></script>
</body>
</html>
